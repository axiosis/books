\addtocontents{toc}{\protect\newpage}
\chapter{–Ü–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –±–µ–∑–ø–µ–∫–∏ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—É}

\section{–ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –ø—ñ–¥–ø–∏—Å —ñ —Ü–∏—Ñ—Ä–æ–≤–∞ –ø–µ—á–∞—Ç–∫–∞}

–ö–≤–∞–ª—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∏–π –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∏–π –ü—ñ–¥–ø–∏—Å, –∞–±–æ –ö–≤–∞–ª—ñ—Ñ—ñ–∫–ª–æ–≤–∞–Ω–∞ –ï–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞ –ü–µ—á–∞—Ç–∫–∞ ---
—Ü–µ –Ω–∞–±—ñ—Ä —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ–≥–æ –∑–∞—Ö–∏—Å—Ç—É –î–°–¢–£ 4145,
—Ç–∞ –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –π–æ–≥–æ –∫–æ–Ω–≤–µ—Ä—Ç: X.501, X.509, X.511, X.520.

\renewcommand{\footnotesize}{\scriptsize}

–°–µ—Ä—ñ—è –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ X.500, –≥—Ä—É–ø—É—î—Ç—å—Å—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä—ñ—è–º, –∫–æ–∂–Ω–∞
–∑ —è–∫–∏—Ö –º–∞—î —Å–≤—ñ–π –ø–µ—Ä–µ–ª—ñ–∫ ASN.1 —Ñ–∞–π–ª—ñ–≤. –ê–±–∏ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏ —É—Å—ñ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ
–¥–ª—è –ö–ï–ü –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –Ω–∞—Å—Ç—É–ø—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ (–≤–∏–¥—ñ–ª–µ–Ω—ñ –±–æ–ª–¥–æ–º):
X.501 --- BasicAccessControl \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x501/2019/BasicAccessControl.html}},
InformationFramework \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x501/2019/InformationFramework.html}},
UsefulDefinitions \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x501/2019/UsefulDefinitions.html}};
X.509 --- SpkmGssTokens \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x509/2019/ExtensionAttributes.html}},
PkiPmiExternalDataTypes \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x509/2019/PkiPmiExternalDataTypes.html}},
AttributeCertificateDefinitions \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x509/2019/AttributeCertificateDefinitions.html}}, \\
AlgorithmObjectIdentifiers \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x509/2019/AlgorithmObjectIdentifiers.html}}, \\
AuthenticationFramework \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x509/2019/AuthenticationFramework.html}},
CertificateExtensions \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x509/2019/CertificateExtensions.html}}; \\
X.511 --- SpkmGssTokens \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x511/2019/SpkmGssTokens.html}},
DirectoryAbstractService \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x511/2019/DirectoryAbstractService.html}};
X.520 --- PasswordPolicy \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x520/2019/PasswordPolicy.html}},
UpperBounds \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x520/2019/UpperBounds.html}},
SelectedAttributeTypes \footnote{\url{https://www.itu.int/ITU-T/formal-language/itu-t/x/x520/2019/SelectedAttributeTypes.html}}.

–ú–æ–∂–Ω–æ –±—É–ª–æ –±–∏ –≤–∏–Ω–µ—Å—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –≤–∏–∑–Ω–∞—á–µ–Ω–Ω—è –æ–¥—Ä–∞–∑—É –≤ KEP.asn1,
–æ–¥–Ω–∞–∫ —Ü–∏–º —Ö–æ—Ç—ñ–ª–æ—Å—è –ø—ñ–¥–∫—Ä–µ—Å–ª–∏—Ç–∏ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—å –∑ –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏–º–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏. –û–∫—Ä—ñ–º —Å–µ—Ä—ñ—ó
–ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ X.500, –ö–ï–ü —â–µ –≤–∏–∑–Ω–∞—á–∞—î —Ç–∞–∫–æ–∂ –∑–∞–ø–∏—Ç–∏ —Ç–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ OCSP, —Ç–∞–∫–æ–∂ —É ASN.1 —Ñ–æ—Ä–º–∞—Ç—ñ.

\newpage
–ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ —Å–∞–º–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º—É –ö–ï–ü, —è–∫–∏–π –≤–∏–∑–Ω–∞—á–µ–Ω–æ –î–°–¢–£ 4145,
–∫–æ–Ω–≤–µ—Ä—Ç–∏ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏, –∞ –Ω–∞–∫–∞–∑–∞–º–∏ –º—ñ–Ω—ñ—Å—Ç–µ—Ä—Å—Ç–≤–∞ —é—Å—Ç–∏—Ü—ñ—ó:
–ü—Ä–æ–µ–∫—Ç –Ω–∞–∫–∞–∑—É –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ü—ñ—ó –î–µ—Ä–∂—Å–ø–µ—Ü–∑–≤'—è–∑–∫—É —Ç–∞ –î–µ—Ä–∂–∫–æ–º—ñ–Ω—Ñ–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó (2009) \footnote{\url{http://www.dsszzi.gov.ua/dsszzi/control/uk/publish/article?art\_id=77726}},
–ù–∞–∫–∞–∑ –ú—ñ–Ω—ñ—Å—Ç–µ—Ä—Å—Ç–≤–∞ —é—Å—Ç–∏—Ü—ñ—ó –£–∫—Ä–∞—ó–Ω–∏ 1236/5/453 \footnote{\url{https://zakon.rada.gov.ua/laws/show/z1401-12}}.
–ö–µ—Ä—É—é—á–∏—Å—å —Ü–∏–º–∏ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–º–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ –±—É–ª–æ —Å—Ç–≤–æ—Ä–µ–Ω–æ —Ñ–∞–π–ª KEP.asn1 \footnote{\url{https://github.com/synrc/ca/blob/master/priv/kep/KEP.asn1}},
—è–∫–∏–π —î –æ–¥–Ω–∏–º –∑ —Ç—Ä—å–æ—Ö top-level —Ñ–∞–π–ª—ñ–≤ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∏—ó –¥–ª—è –∫–æ–º–ø—ñ–ª—è—Ü—ñ—ó ASN.1 –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–æ–º\footnote{\url{https://asn1.erp.uno}}.

–Ü—Å–Ω—É—î –Ω–µ–±–∞–≥–∞—Ç–æ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏—Ö —Ç–∞ –ø–æ–≤–Ω–∏—Ö –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä—ñ–≤ (–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä—ñ–≤ –ø–∞—Ä—Å–µ—Ä—ñ–≤)
ASN.1 —Å–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ–π. Erlang —î –ø—Ä–∏–∫–ª–∞–¥–æ–º —Å–∏—Å—Ç–µ–º–∏, –¥–æ —Å–∫–ª–∞–¥—É —è–∫–æ—ó –≤—Ö–æ–¥–∏—Ç—å
–ø–µ—Ä—à–æ–∫–ª–∞—Å–Ω–∏–π –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω–∏–π –∑ –≤—ñ–¥–∫—Ä–∏—Ç–æ—é –ª—ñ—Ü–µ–Ω—Ü—ñ—î—é ASN.1 –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä, –¥–µ
—Ñ–∞–π–ª–∏ –≤ ASN.1 –Ω–æ—Ç–∞—Ü—ñ—ó –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑–∫–æ–º–ø—ñ–ª—å–æ–≤–∞–Ω—ñ –±–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ Erlang –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–æ–º:

\renewcommand{\footnotesize}{\normal}

\begin{lstlisting}
> erlc AuthenticationFramework.asn1
> erlc InformationFramework.asn1
> erlc KEP.asn1
\end{lstlisting}

–°—Ç–≤–æ—Ä–∏—Ç–∏ —Ñ–∞–π–ª –ø—ñ–¥–ø–∏—Å—É PKCS-7 –º–æ–∂–Ω–∞ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –±—É–¥—å —è–∫–æ—ó –ø—Ä–æ–≥—Ä–∞–º–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–æ–≤–∞–Ω–æ—ó –≤ –£–∫—Ä–∞—ó–Ω—ñ.
–ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–µ –æ—Ç—Ä–∏–º–∞—Ç–∏ —Å–≤–æ—é –ö–ï–ü –ø–µ—á–∞—Ç–∫—É –±—É–¥—É—á–∏ –∫–ª—ñ—î–Ω—Ç–æ–º –ü—Ä–∏–≤–∞—Ç–ë–∞–Ω–∫—É. –ó–∞ –¥–æ–ø–æ–º–æ–≥–æ—é
"–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¶–°–ö" –∫–æ–º–ø–∞–Ω—ñ—ó –Ü–Ü–¢ –≤–∏ –º–æ–∂–µ—Ç–µ –ø—ñ–¥–ø–∏—Å—É–≤–∞—Ç–∏ —Ñ–∞–π–ª–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –±–µ–∑–∫–æ—à—Ç–æ–≤–Ω—É
—Ñ–æ—Ä–º—É –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ —É –≤–∏–≥–ª—è–¥—ñ –∑–≤–∏—á–∞–π–Ω–æ–≥–æ —Ñ–∞–π–ª—É.

\newpage
\subsection{–ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è}

–©–æ–± –ø–æ–∫–∞–∑–∞—Ç–∏ —è–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è –ö–ï–ü, —Ç–∞ –ø—Ä–æ—á–∏—Ç–∞—Ç–∏ –∞—Ç—Ä–∏–±—É—Ç–∏–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –∑ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É,
—è–∫–∏–π –≤—à–∏—Ç–∏–π –≤ PCKS-7 –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–º –ø—ñ–¥–ø–∏—Å–æ–º, –ø–æ–∫–∞–∂–µ–º–æ 5 —Ñ—É–Ω–∫—Ü—ñ–π:

\renewcommand{\footnotesize}{\scriptsize}

\begin{lstlisting}[utf8]
> CA.CAdES.readSignature
[
  {:certinfo, ~c"TINUA-2955020254",
   "–°–û–•–ê–¶–¨–ö–ò–ô –ú–ê–ö–°–ò–ú –ï–†–û–¢–ï–ô–û–í–ò–ß",
   "–ú–ê–ö–°–ò–ú –ï–†–û–¢–ï–ô–û–í–ò–ß", "–°–û–•–ê–¶–¨–ö–ò–ô",
   "–°–û–•–ê–¶–¨–ö–ò–ô –ú–ê–ö–°–ò–ú –ï–†–û–¢–ï–ô–û–í–ò–ß",
   [
     subjectKeyIdentifier: "VNXfTvJQccGtPgNhUftIQZV+mUROTgroLotsbtYZsFE=",
     authorityKeyIdentifier: "XphNUm+C84/0vi5ABGgN/rOvysLkBHVNB9CuTISwfB0=",
     keyUsage: [<<6, 192>>],
     certificatePolicies: {"https://acsk.privatbank.ua/acskdoc",
      ["1.2.804.2.1.1.1.2.2", "1.3.6.1.5.5.7.2.1"]},
     basicConstraints: [],
     qcStatements: {"https://acsk.privatbank.ua",
      ["0.4.0.1862.1.1", "0.4.0.1862.1.5", "1.3.6.1.5.5.7.11.2",
       "0.4.0.194121.1.1", "1.2.804.2.1.1.1.2.1"]},
     cRLDistributionPoints: ["http://acsk.privatbank.ua/crl/PB-2023-S6.crl"],
     freshestCRL: ["http://acsk.privatbank.ua/crldelta/PB-Delta-2023-S6.crl"],
     authorityInfoAccess: [
       {"1.3.6.1.5.5.7.48.2",
        "http://acsk.privatbank.ua/arch/download/PB-2023.p7b"},
       {"1.3.6.1.5.5.7.48.1", "http://acsk.privatbank.ua/services/ocsp/"}
     ],
     subjectInfoAccess: [
       {"1.3.6.1.5.5.7.48.3", "http://acsk.privatbank.ua/services/tsp/"}
     ],
     subjectDirectoryAttributes: [
       {"1.2.804.2.1.1.1.11.1.4.7.1", "0"},
       {"1.2.804.2.1.1.1.11.1.4.1.1", "2955020254"}
     ]
   ], "–§–Ü–ó–ò–ß–ù–ê –û–°–û–ë–ê", "", "", ~c"UA", "–ö–ò–á–í"},
  {:certinfo, ~c"UA-14360570-2310",
   "–ö–ù–ï–î–ü –ê–¶–°–ö –ê–¢ –ö–ë \"–ü–†–ò–í–ê–¢–ë–ê–ù–ö\"", "", "",
   "–ö–ù–ï–î–ü –ê–¶–°–ö –ê–¢ –ö–ë \"–ü–†–ò–í–ê–¢–ë–ê–ù–ö\"",
   [
     contentType: "0.6.9.42.840.113549.1.7.1",
     signingTime: "240221110356Z",
     messageDigest: "MfvlhoDVCPkptQRN+S2zNGp0nrOsS93mLdbcz/kZ9GI=",
     signingCertificateV2: 540041581425012649131508804155871837613877419268,
     contentTimestamp: {"1.2.840.113549.1.7.2",
      36995253346304402407284752111874897026, "20240221110626Z",
      "MfvlhoDVCPkptQRN+S2zNGp0nrOsS93mLdbcz/kZ9GI="}
   ], "–ê–¢ –ö–ë \"–ü–†–ò–í–ê–¢–ë–ê–ù–ö\"", "", "", ~c"UA", "–ö–∏—ó–≤"}
]
\end{lstlisting}
\renewcommand{\footnotesize}{\normal}

\newpage
\section{–ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ–π–Ω—ñ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è}

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ø–æ–≤–∏–Ω–Ω—ñ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤, —É–∑–≥–æ–¥–∂–µ–Ω–Ω—è –∫–ª—é—á—ñ–≤
—ñ —Ä–∞–Ω—ñ—à–µ —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—ñ —Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ –∫–ª—é—á—ñ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∫–ª—é—á—ñ–≤, –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω—ñ ktri,
kari —Ç–∞ kekri –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ.

–†–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –º–æ–∂—É—Ç—å –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–ª—é—á–∞–º–∏ –Ω–∞ –æ—Å–Ω–æ–≤—ñ –ø–∞—Ä–æ–ª—è,
–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–µ pwri. –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—ó –ú–û–ñ–£–¢–¨ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫—ñ —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏
–∫–µ—Ä—É–≤–∞–Ω–Ω—è –∫–ª—é—á–∞–º–∏, —Ç–∞–∫—ñ —è–∫ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –ë–æ–Ω–µ-–§—Ä–∞–Ω–∫–ª—ñ–Ω–∞
—Ç–∞ –ë–æ–Ω–µ-–ë–æ–π—î–Ω–∞ (RFC 5409) –∞–±–æ —ñ–Ω—à—ñ –º–µ—Ç–æ–¥–∏ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è SYNRC, —Ç–∞–∫—ñ —è–∫ –≤–∞—Ä—ñ–∞–Ω—Ç–∏
KYBER Key Transport (LAMPS-WG) –¥–ª—è –ø–æ—Å—Ç–∫–≤–∞–Ω—Ç–æ–≤–æ—ó –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—ó (PQC).

IETF (SMIME-WG) —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏: 5990, 5911, 5750--5754, 5652, 5408, 5409,
5275, 5126, 5035, 4853, 4490, 4262, 4134, 4056, 4010, 3850, 3851,
3852, 3854, 3855, 3657, 3560, 3565, 3537, 3394, 3369, 3370, 3274,
3114, 3278, 3218, 3211, 3217, 3183, 3185, 3125--3126, 3058, 2984,
2876, 2785, 2630, 2631, 2632 , 2633, 5083, 5084, 2634.

–°—É–º—ñ—Å–Ω—ñ—Å—Ç—å: Erlang SSL, LibreSSL CMS, OpenSSL CMS, GnuPG S/MIME.

\subsection{–ì–æ–ª–æ–≤–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è}

–°–ø–µ—Ü–∏—Ñ—ñ–∫–∞—Ü—ñ—è —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—É –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å CMS X.509 –¥–ª—è
–¥–∏—Å—Ü–∏–ø–ª—ñ–Ω–∏ RSA (Key Transport), ECC (Key Agreement), KEK (Key Encryption Key)
–¥–ª—è –¥–æ–¥–∞—Ç–∫—ñ–≤ Erlang/OTP, —è–∫—ñ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –ø—Ä–µ–∂–∏–≤–∞–ª–∞ heartbleed (!) CRYPTO —Ç–∞ SSL.
–†–µ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ —è–∫ –º–æ–¥—É–ª—å CMS –ø—Ä–æ–≥—Ä–∞–º–∏ CA.

\renewcommand{\footnotesize}{\scriptsize}

\begin{lstlisting}
defmodule CMS do
    def decrypt(cms, {schemeOID, privateKeyBin}) do
        {_,{:ContentInfo,_,{:EnvelopedData,_,_,x,y,_}}} = cms
        {:EncryptedContentInfo,_,{_,encOID,{_,<<_::16,iv::binary>>}},data} = y
              case :proplists.get_value(:kari,  x, []) do
        [] -> case :proplists.get_value(:ktri,  x, []) do
        [] -> case :proplists.get_value(:kekri, x, []) do
        [] -> case :proplists.get_value(:pwri,  x, []) do
        [] -> {:error, "Unknown Other Recepient Info"}
              pwri  -> pwri(pwri,   privateKeyBin, encOID, data, iv) end
              kekri -> kekri(kekri, privateKeyBin, encOID, data, iv) end
              ktri  -> ktri(ktri,   privateKeyBin, encOID, data, iv) end
              kari  -> kari(kari,   privateKeyBin, schemeOID, encOID, data, iv) end
    end
end
\end{lstlisting}

\newpage
\subsection{CMS-KARI-ECC}

IETF 3278:2002 –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∞–ª–≥–æ—Ä–∏—Ç–º—ñ–≤ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—ó –µ–ª—ñ–ø—Ç–∏—á–Ω–∏—Ö
–∫—Ä–∏–≤–∏—Ö (ECC) —É —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—ñ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏—Ö –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å (CMS) —ñ–∑
–ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é Suite B IETF 5008:2007, 6318:2011.

\begin{lstlisting}
$ openssl cms -decrypt -in encrypted.txt -inkey client.key -recip client.pem
$ openssl cms -encrypt -aes256 -in message.txt -out encrypted.txt \
                       -recip client.pem -keyopt ecdh_kdf_md:sha256
\end{lstlisting}

CMS Codec KARI: ECC+KDF/ECB+AES/KW+256/CBC:

\begin{lstlisting}
def map(:'dhSinglePass-stdDH-sha512kdf-scheme'), do: :sha512
def map(:'dhSinglePass-stdDH-sha384kdf-scheme'), do: :sha384
def map(:'dhSinglePass-stdDH-sha256kdf-scheme'), do: :sha256
def eccCMS(ukm, bit), do:
    :'CMSECCAlgs-2009-02'.encode(:'ECC-CMS-SharedInfo', sharedInfo(ukm, bit))
def sharedInfo(ukm, len), do: {:'ECC-CMS-SharedInfo',
    {:'KeyWrapAlgorithm',{2,16,840,1,101,3,4,1,45},:asn1_NOVALUE}, ukm, <>}

def kari(kari, privateKeyBin, schemeOID, encOID, data, iv) do
    {_,:v3,{_,{_,_,publicKey}},ukm,{_,kdfOID,_},[{_,_,encryptedKey}]} = kari
    {scheme,_}  = CA.ALG.lookup(schemeOID)
    {kdf,_}     = CA.ALG.lookup(kdfOID)
    {enc,_}     = CA.ALG.lookup(encOID)
    sharedKey   = :crypto.compute_key(:ecdh,publicKey,privateKeyBin,scheme)
    {_,payload} = eccCMS(ukm, 256)
    derived     = KDF.derive(map(kdf), sharedKey, 32, payload)
    unwrap      = CA.AES.KW.unwrap(encryptedKey, derived)
    res         = CA.AES.decrypt(enc, data, unwrap, iv)
    {:ok, res}
end
def testDecryptECC(), do: CA.CMS.decrypt(testECC(), testPrivateKeyECC())

def testECC() do
    {:ok,base} = :file.read_file "priv/certs/encrypted.txt"
    [_,s] = :string.split base, "\n\n"
    x = :base64.decode s
    :'CryptographicMessageSyntax-2010'.decode(:ContentInfo, x)
end

def testPrivateKeyECC() do
    privateKey = :public_key.pem_entry_decode(pem("priv/certs/client.key"))
    {:'ECPrivateKey',_,privateKeyBin,{:namedCurve,schemeOID},_,_} = privateKey
    {schemeOID,privateKeyBin}
end
\end{lstlisting}


\newpage
\subsection{CMS-KEKRI-KEK}

–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –æ–¥–µ—Ä–∂—É–≤–∞—á–∞ –∫–ª—é—á–∞ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –∫–ª—é—á–∞, —è–∫ –≤–∏–∑–Ω–∞—á–µ–Ω–æ CMS IETF 5652:2009, 3852:2004, 3369:2002, 2630:1999.

\begin{lstlisting}
$ openssl cms -encrypt -secretkeyid 07 \
              -secretkey 0123456789ABCDEF0123456789ABCDEF \
              -aes256 -in message.txt -out encrypted2.txt

$ openssl cms -decrypt -in encrypted2.txt -secretkeyid 07 \
              -secretkey 0123456789ABCDEF0123456789ABCDEF
\end{lstlisting}

CMS Codec KEKRI: KEK+AES-KW+CBC:

\begin{lstlisting}
def kekri(kekri, privateKeyBin, encOID, data, iv) do
    {:'KEKRecipientInfo',_vsn,_,{_,kea,_},encryptedKey} = kekri
    _ = CA.ALG.lookup(kea)
    {enc,_} = CA.ALG.lookup(encOID)
    unwrap = CA.AES.KW.unwrap(encryptedKey,privateKeyBin)
    res = CA.AES.decrypt(enc, data, unwrap, iv)
    {:ok, res}
end
def testDecryptKEK(), do: CA.CMS.decrypt(testKEK(), testPrivateKeyKEK())

def testPrivateKeyKEK() do
    {:kek, :binary.decode_hex("0123456789ABCDEF0123456789ABCDEF")}
end

def testKEK() do
    {:ok,base} = :file.read_file "priv/certs/encrypted2.txt"
    [_,s] = :string.split base, "\n\n"
    x = :base64.decode s
    :'CryptographicMessageSyntax-2010'.decode(:ContentInfo, x)
end
\end{lstlisting}

\newpage
\subsection{CMS-KTRI-RSA}

The very first CMS IETF 3852:1999:

\begin{lstlisting}
# gpgsm --list-keys
# gpgsm --list-secret-keys
# gpgsm -r 0xD3C8F78A -e CNAME > cms.bin
# gpgsm -u 0xD3C8F78A -d cms.bin
# gpgsm --export-secret-key-p12 0xD3C8F78A > key.bin
# openssl pkcs12 -in key.bin -nokeys -out public.pem
# openssl pkcs12 -in key.bin -nocerts -nodes -out private.pem
\end{lstlisting}

CMS Codec KTRI: RSA+RSAES-OAEP:

\begin{lstlisting}
def ktri(ktri, privateKeyBin, encOID, data, iv) do
    {:'KeyTransRecipientInfo',_vsn,_,{_,schemeOID,_},key} = ktri
    {:rsaEncryption,_} = CA.ALG.lookup schemeOID
    {enc,_} = CA.ALG.lookup(encOID)
    sessionKey = :public_key.decrypt_private(key, privateKeyBin)
    res = CA.AES.decrypt(enc, data, sessionKey, iv)
    {:ok, res}
end
def testDecryptRSA(), do: CA.CMS.decrypt(testRSA(), testPrivateKeyRSA())

def testPrivateKeyRSA() do
    {:ok,bin} = :file.read_file("priv/rsa-cms.key")
    pki = :public_key.pem_decode(bin)
    [{:PrivateKeyInfo,_,_}] = pki
    rsa = :public_key.pem_entry_decode(hd(pki))
    {:'RSAPrivateKey',:'two-prime',_n,_e,_d,_,_,_,_,_,_} = rsa
    {:rsaEncryption,rsa}
end

def testRSA() do
    {:ok,x} = :file.read_file "priv/rsa-cms.bin"
    :'CryptographicMessageSyntax-2010'.decode(:ContentInfo, x)
end
\end{lstlisting}

\subsection{KDF}

KDF (MD5: 128, SHA: 160‚Äî512) and HKDF (HMAC) Key Derive functions used in ECC CMS schemes as of NIST SP 800-108r1.

\begin{lstlisting}
defmodule KDF do
    def hl(:md5),    do: 16
    def hl(:sha),    do: 20
    def hl(:sha224), do: 28
    def hl(:sha256), do: 32
    def hl(:sha384), do: 48
    def hl(:sha512), do: 64

    def derive(h, d, len, x) do
        :binary.part(:lists.foldr(fn i, a ->
            :crypto.hash(h, d <> <> <> x) <> a
        end, <<>>, :lists.seq(1,round(Float.ceil(len/hl(h))))), 0, len)
    end
end
\end{lstlisting}

\newpage
\subsection{AES-KW}

AES Key Wrap function is applicable to keys of 128/192/256 bit using AES-ECB encoding as of RFC 5649:2009 Advanced Encryption Standard (AES) Key Wrap with Padding Algorithm.

\begin{lstlisting}
-define(MSB64,      1/unsigned-big-integer-unit:64).
-define(DEFAULT_IV, << 16#A6A6A6A6A6A6A6A6:?MSB64 >>).

unwrap(CipherText, KEK) -> unwrap(CipherText, KEK, ?DEFAULT_IV).
unwrap(CipherText, KEK, IV)
        when (byte_size(CipherText) rem 8) =:= 0
        andalso (bit_size(KEK) =:= 128
            orelse bit_size(KEK) =:= 192
            orelse bit_size(KEK) =:= 256) ->
    BlockCount = (byte_size(CipherText) div 8) - 1,
    IVSize = byte_size(IV),
    case do_unwrap(CipherText, 5, BlockCount, KEK) of
        << IV:IVSize/binary, PlainText/binary >> ->
            PlainText;
        _ ->
            erlang:error({badarg, [CipherText, KEK, IV]})
    end.

codec(128) -> aes_128_ecb;
codec(192) -> aes_192_ecb;
codec(256) -> aes_256_ecb.

do_unwrap(Buffer, J, _BlockCount, _KEK) when J < 0 -> Buffer;
do_unwrap(Buffer, J, BlockCount, KEK) ->
    do_unwrap(do_unwrap(Buffer, J, BlockCount, BlockCount, KEK),
              J - 1, BlockCount, KEK).
do_unwrap(Buffer, _J, I, _BlockCount, _KEK) when I < 1 -> Buffer;
do_unwrap(<< A0:?MSB64, Rest/binary >>, J, I, BlockCount, KEK) ->
    HeadSize = (I - 1) * 8,
    << Head:HeadSize/binary, B0:8/binary, Tail/binary >> = Rest,
    Round = (BlockCount * J) + I,
    A1 = A0 bxor Round,
    Data = << A1:?MSB64, B0/binary >>,
    << A2:8/binary, B1/binary >>
        = crypto:crypto_one_time(codec(bit_size(KEK)),
          KEK, ?DEFAULT_IV, Data, [{encrypt,false}]),
    do_unwrap(<< A2/binary, Head/binary, B1/binary,
          Tail/binary >>, J, I - 1, BlockCount, KEK).
\end{lstlisting}

\newpage
\subsection{AES-256}

All AES-256 flavours are implemented for a wide range of ECC Key Agreement schemes.

\begin{lstlisting}
def decrypt(crypto_codec, data, key, iv \\ :crypto.strong_rand_bytes(16))
def decrypt(:'id-aes256-ECB',data,key,iv), do: decryptAES256ECB(data,key,iv)
def decrypt(:'id-aes256-CBC',data,key,iv), do: decryptAES256CBC(data,key,iv)
def decrypt(:'id-aes256-GCM',data,key,iv), do: decryptAES256GCM(data,key,iv)
def decrypt(:'id-aes256-CCM',data,key,iv), do: decryptAES256CCM(data,key,iv)
def test() do
  [
    check_SECP384R1_GCM256(),
    check_X25519_GCM256(),
    check_C2PNB368w1_GCM256(),
    check_BrainPoolP512t1_GCM256(),
    check_BrainPoolP512t1_GCM256(),
    check_SECT571_GCM256(),
    check_X448_GCM256(),
    check_X448_CBC256(),
    check_X448_ECB256(),
  ]
end
\end{lstlisting}

\newpage
\section{–Ü–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—è CMP —Å–µ—Ä–≤–µ—Ä–∞ —É —Å–∫–ª–∞–¥—ñ –ê–¶–°–ö}

IETF follow up (PKIX): 7030, 6960, 6818, 6844, 6712, 6664, 6402, 6277, 6170, 6024, 6025, 5934, 5912--5914, 5877, 5816, 5755, 5756, 5758, 5697, 5636, 5480, 5272--5274, 5280, 5055, 5019, 4985, 4683, 4630, 4476, 4387, 4325, 4158, 4210, 4211, 4055, 4043, 3874, 3779, 3820, 3739, 3709, 3628, 3161, 3029, 2797, 2559, 2587, 3039, 3029, 2511, 2510.

Compatibility: OpenSSL, Cisco, Red Hat, Siemens, Nokia, IBM.

–¶—è —Å—Ç–∞—Ç—Ç—è –º–æ–≥–ª–∞ –±–∏ –Ω–∞–∑–∏–≤–∞—Ç–∏ ¬´–Ø–∫ –Ω–∞–ø–∏—Å–∞—Ç–∏ CMP —Å–µ—Ä–≤–µ—Ä –∑–∞ 30 —Ö–≤–∏–ª–∏–Ω¬ª,
 –∞–ª–µ –Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó —Å—Ç–∞—Ç—Ç—ñ –ø—Ä–æ LDAP, —Ü—è –≤–∂–µ –ø–æ–∫—Ä–∏–≤–∞—î –±—ñ–ª—å—à–µ –Ω—ñ–∂ —Ç—É–∑—ñ–Ω—å ASN.1 —Ñ–∞–π–ª—ñ–≤, –¥–æ–±—Ä–µ —à–æ –º–∏ –≤–∂–µ –ø–æ–∑–Ω–∞–π–æ–º–∏–ª–∏—Å—è –∑ CMS —Ç–∞ LDAP –±—ñ–±—ñ–ª—ñ–æ—Ç–µ–∫–∞–º–∏ —Ç–∞ —ó—Ö ASN.1 —Ñ–∞–π–ª–∞–º–∏. –í —Ü—ñ–π —Å—Ç–∞—Ç—Ç—ñ –ø—Ä–æ CMP –Ω–∞—Å –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ü—ñ–∫–∞–≤–∏—Ç–∏–º—É—Ç—å PKIXCMP-2009, PKIXCRMF-2009 —Ç–∞ EnrollmentMessageSyntax-2009 –¥–ª—è CMC.

\renewcommand{\footnotesize}{\scriptsize}

\begin{lstlisting}
CMS-AES-CCM-and-AES-GCM-2009.asn1
CMSAesRsaesOaep-2009.asn1
CMSECCAlgs-2009-02.asn1
CMSECDHAlgs-2017.asn1
CryptographicMessageSyntax-2009.asn1
CryptographicMessageSyntax-2010.asn1
CryptographicMessageSyntaxAlgorithms-2009.asn1
EnrollmentMessageSyntax-2009.asn1
PKCS-10.asn1
PKCS-7.asn1
PKIX1Explicit-2009.asn1
PKIX1Implicit-2009.asn1
PKIXAlgs-2009.asn1
PKIXCMP-2009.asn1
PKIXCRMF-2009.asn1
\end{lstlisting}

\newpage
\subsection{CSR}

–û—Ç–∂–µ –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –Ω–∞–ø–∏—Å–∞–Ω–Ω—è CMP —Å–µ—Ä–≤–µ—Ä—É –∑ –Ω–∞–π–≥–æ–ª–æ–≤–Ω—ñ—à–æ—ó –π–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ—ó: –≤–∏–¥–∞—á—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É –ø–æ PCKS-10 CSR —Ä–µ–∫–≤–µ—Å—Ç—É. –°—Ö–µ–º–∞ –Ω–∞—Å—Ç—É–ø–Ω–∞: –ö–ª—ñ—î–Ω—Ç –≥–µ–Ω–µ—Ä—É—î –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á, –∫–æ–Ω–≤–µ—Ä—Ç—É—î –π–æ–≥–æ –≤ PEM —Ñ–∞–π–ª, –≤—ñ–¥—Å–∏–ª–∞—î —è–∫ P10CR –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É —Å–∫–ª–∞–¥—ñ payload PKIMessage, –æ—Ç—Ä–∏–º—É—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å CP, –ø—ñ—Å–ª—è —á–æ–≥–æ –∫–ª—ñ—î–Ω—Ç —à–ª–µ —â–µ –æ–¥–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è CERTCONF, –ø—ñ—Å–ª—è —è–∫–æ–≥–æ CMP —Å–µ—Ä–≤–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø–æ–≤–∏—Å—Ç–∏ PKICONF –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º.


\begin{lstlisting}
 def csr(user) do
      {ca_key, ca} = read_ca()
      priv = X509.PrivateKey.new_ec(:secp384r1)
      der = :public_key.der_encode(:ECPrivateKey, priv)
      pem = :public_key.pem_encode([{:ECPrivateKey, der, :not_encrypted}])
      :file.write_file(user <> ".key", pem)
      :io.format '~p~n', [priv]
      csr = X509.CSR.new(priv, "/C=UA/L=Kyiv/O=SYNRC/CN=" <> user,
         extension_request: [
            X509.Certificate.Extension.subject_alt_name(["n2o.dev"])])
      :io.format 'CSR: ~p~n', [csr]
      :file.write_file(user <> ".csr", X509.CSR.to_pem(csr))
      true = X509.CSR.valid?(csr)
      subject = X509.CSR.subject(csr)
      :io.format 'Subject ~p~n', [subject]
      :io.format 'CSR ~p~n', [csr]
      X509.Certificate.new(X509.CSR.public_key(csr), subject, ca, ca_key,
         extensions: [subject_alt_name:
           X509.Certificate.Extension.subject_alt_name(["n2o.dev", "erp.uno"]) ])
      csr
  end
\end{lstlisting}

\newpage
–ü–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º —Ä–æ–±–æ—Ç–∏ CMP —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ–≤–∏–Ω–µ–Ω –±—É—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π —Ä—É—Ç–æ–≤–∏–π CA —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –∑ –ø—Ä–∏–≤–∞—Ç–Ω–∏–º –∫–ª—é—á–µ–º, —Ü—ñ –¥–≤–∞ —Ñ–∞–π–ª–∞ –º–∏ –∑–±–µ—Ä—ñ–≥–∞—î–º–æ –Ω–∞ –¥–∏—Å–∫, —ñ —É –≤—Å—ñ—Ö –ø–æ–¥–∞–ª—å—à–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ—è—Ö –∫–æ—Ä–∏—Å—Ç—É—î–º–æ—Å—è –Ω–∏–º–∏. –î–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Ñ–∞–π–ª—ñ–≤ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é CA.CSR.ca.

\begin{lstlisting}
 def ca() do
      ca_key = X509.PrivateKey.new_ec(:secp384r1)
      ca = X509.Certificate.self_signed(ca_key,
            "/C=UA/L=Kyiv/O=SYNRC/CN=CSR-CMP", template: :root_ca)
      der = :public_key.der_encode(:ECPrivateKey, ca_key)
      pem = :public_key.pem_encode([{:ECPrivateKey, der, :not_encrypted}])
      :file.write_file "ca.key", pem
      :file.write_file "ca.pem", X509.Certificate.to_pem(ca)
      {ca_key, ca}
  end

  def read_ca() do
      {:ok, ca_key_bin} = :file.read_file "ca.key"
      {:ok, ca_bin} = :file.read_file "ca.pem"
      {:ok, ca_key} = X509.PrivateKey.from_pem ca_key_bin
      {:ok, ca} = X509.Certificate.from_pem ca_bin
      {ca_key, ca}
  end
\end{lstlisting}

–î–ª—è –æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ—ó—ó –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤ —è–∫—ñ –æ–±—Å—É–≥–æ–≤—É—é—Ç—å –∫–ª—ñ—î–Ω—Ç—Å—å–∫—ñ TLS —Å–µ—Å—ñ—ó –º–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω–∏–π –∫–æ–¥.

\begin{lstlisting}
  def server(name) do
      {ca_key, ca} = read_ca()
      server_key = X509.PrivateKey.new_ec(:secp384r1)
        X509.Certificate.new(X509.PublicKey.derive(server_key),
           "/C=UA/L=Kyiv/O=SYNRC/CN=" <> name, ca, ca_key,
           extensions: [subject_alt_name:
              X509.Certificate.Extension.subject_alt_name(["n2o.dev", "erp.uno"]) ])
  end
\end{lstlisting}

\newpage
\subsection{CMS}

–î–µ—Ç–∞–ª—å–Ω–æ —Å—ñ–º–µ–π—Å—Ç–≤–æ –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ —ñ CMS –∫–æ–¥—É–≤–∞–Ω–Ω—è –æ–ø–∏—Å–∞–Ω–æ –≤ –æ–∫—Ä–µ–º—ñ–π —Å—Ç–∞—Ç—Ç—ñ –ø—Ä–∏—Å–≤—è—á–µ–Ω—ñ–π CMS Compliance. CMS –∫–æ–¥—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —Ç—ñ–ª—å–∫–∏ –¥–ª—è CMC —Å–µ—Ä–≤–µ—Ä–∞, —Ç–æ–º—É –º–∏ —Ü–µ –ø–æ–∫–∏ –≤–∏—Å–≤—ñ—Ç–ª—é–≤–∞—Ç–∏ –Ω–µ –±—É–¥–µ–º–æ.

\subsubsection{CMP/CSR/TCP}

RFC 6712, 4210. –î–ª—è –ø–æ—á–∞—Ç–∫—É –Ω–∞–ø–∏—à–µ–º–æ –ø—Ä–æ—Å—Ç–∏–π PKIMessage —Å–µ—Ä–≤–µ—Ä.

\begin{lstlisting}
defmodule CA.CMP do
  @moduledoc "CA/CMP TCP server."
  require CA

  def start(), do: :erlang.spawn(fn -> listen(1829) end)
  def listen(port) do
      {:ok, socket} = :gen_tcp.listen(port,
        [:binary, {:packet, 0}, {:active, false}, {:reuseaddr, true}])
      accept(socket)
  end

  def accept(socket) do
      {:ok, fd} = :gen_tcp.accept(socket)
      :erlang.spawn(fn -> __MODULE__.loop(fd) end)
      accept(socket)
  end

  def loop(socket) do
      case :gen_tcp.recv(socket, 0) do
           {:ok, data} ->
               [headers,body] = :string.split data, "\r\n\r\n", :all
               {:ok,dec} = :'PKIXCMP-2009'.decode(:'PKIMessage', body)
               {:PKIMessage, header, body, code, _extra} = dec
               __MODULE__.message(socket, header, body, code)
               loop(socket)
          {:error, :closed} -> :exit
      end
  end
\end{lstlisting}

\newpage
\subsubsection{PKIMessage.protection}

–†–æ–∑–±–µ—Ä–µ–º–æ—Å—è –∑ –ø–æ–ª–µ–º PKIMessage.protection, –≤ —è–∫–æ–º—É –∑–±–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç PBKDF2 –∞–ª–≥–æ—Ä–∏—Ç–º–∞. –ú–∞–π—Ç–µ –Ω–∞ —É–≤–∞–∑—ñ —à–æ OpenSSL –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î 20-–±–∞–π—Ç–Ω—ñ –∫–ª—é—á—ñ —Ç–∞ HMAC/SHA-1 —É —è–∫–æ—Å—Ç—ñ MAC —Ñ—É–Ω–∫—Ü—ñ—ó, —Ö–æ—á–∞ OWF –≤ 500 —ñ—Ç–µ—Ä–∞—Ü—ñ—è—Ö –æ–±—á–∏—Å–ª—é—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é OWF —Ñ—É–Ω–∫—Ü—ñ—ó SHA-256.

\subsubsection{ANSWER}

–û—Å–∫—ñ–ª—å–∫–∏ CMP —Å–µ—Ä–≤–µ—Ä –ø–æ–≤–∏–Ω–µ–Ω –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –ø–æ HTTP/1.0 –∑–≥—ñ–¥–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ –¥–æ–¥–∞—î–º–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ HTTP –∑–∞–≥–æ–ª–æ–≤–∫–∏.

\begin{lstlisting}
 def answer(socket, header, body, code) do
      message = CA."PKIMessage"(header: header, body: body, protection: code)
      {:ok, bytes} = :'PKIXCMP-2009'.encode(:'PKIMessage', message)
      res =  "HTTP/1.0 200 OK\r\n"
          <> "Server: SYNRC CA/CMP\r\n"
          <> "Content-Type: application/pkixcmp\r\n\r\n"
          <> :erlang.iolist_to_binary(bytes)
      :gen_tcp.send(socket, res)
  end
\end{lstlisting}

\subsubsection{P10CR/CP}

–ó–∞–ø—É—Å–∫–∞—î–º–æ —Å–µ—Ä–≤–µ—Ä —Ç–∞ –≥–µ–Ω–µ—Ä—É—î–º–æ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ CA —Ç–∞ CSR –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞:

\begin{lstlisting}
$ mix deps.get
$ iex -S mix
> CA.CSR.ca
> CA.CSR.csr "maxim"
\end{lstlisting}

–ó–∞–ø—É—Å–∫–∞—î–º–æ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π –∑–∞–ø–∏—Ç –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é OpenSSL:

\begin{lstlisting}
# openssl cmp -cmd p10cr -server localhost:1829 \
#             -path . -srvcert ca.pem -ref cmptestp10cr \
#             -secret pass:0000 -certout $client.pem -csr $client.csr
\end{lstlisting}

\newpage
–ü–∏—à–µ–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –≤–∏–¥–∞—á—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—É:

\begin{lstlisting}
def message(socket, header, {:p10cr, csr} = body, code) do
      {:PKIHeader, pvno, from, to, messageTime, protectionAlg,
         _senderKID, _recipKID, transactionID, senderNonce,
         _recipNonce, _freeText, _generalInfo} = header
      true = code == validateProtection(header, body, code)

      {ca_key, ca} = CA.CSR.read_ca()
      subject = X509.CSR.subject(csr)
      :io.format '~p~n',[subject]
      true = X509.CSR.valid?(CA.parseSubj(csr))
      cert = X509.Certificate.new(X509.CSR.public_key(csr),
         CA.CAdES.subj(subject), ca, ca_key,
         extensions: [subject_alt_name:
            X509.Certificate.Extension.subject_alt_name(["synrc.com"]) ])

      reply = CA."CertRepMessage"(response:
            [ CA."CertResponse"(certReqId: 0,
              certifiedKeyPair: CA."CertifiedKeyPair"(certOrEncCert:
                {:certificate, {:x509v3PKCert, CA.convertOTPtoPKIX(cert)}}),
              status: CA."PKIStatusInfo"(status: 0))])

      pkibody = {:cp, reply}
      pkiheader = CA."PKIHeader"(sender: to, recipient: from, pvno: pvno,
          recipNonce: senderNonce, transactionID: transactionID,
          protectionAlg: protectionAlg, messageTime: messageTime)
      answer(socket, pkiheader, pkibody,
          validateProtection(pkiheader, pkibody, code))
  end
\end{lstlisting}

\newpage
\subsubsection{CERTCONF/PKICONF}

\begin{lstlisting}
def message(socket, header, {:certConf, statuses}, code) do
      {:PKIHeader, _, from, to, _, _, _, _, _, senderNonce, _, _, _} = header

      :lists.map(fn {:CertStatus,bin,no,{:PKIStatusInfo, :accepted, _, _}} ->
          :logger.info 'CERTCONF ~p request ~p~n', [no,:binary.part(bin,0,8)]
      end, statuses)

      pkibody = {:pkiconf, :asn1_NOVALUE}
      pkiheader = CA."PKIHeader"(header, sender: to, recipient: from,
          recipNonce: senderNonce)
      answer(socket, pkiheader, pkibody,
          validateProtection(pkiheader, pkibody, code))
  end
\end{lstlisting}

–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤ –∫–æ–Ω—Å–æ–ª—ñ –ø–æ–≤–∏–Ω–Ω—ñ —Å–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—Ç–∏:

\begin{lstlisting}
CMP info: sending P10CR
CMP info: received CP
CMP info: sending CERTCONF
CMP info: received PKICONF
CMP info: received 1 enrolled certificate(s), saving to file 'maxim.pem'
\end{lstlisting}

\subsubsection{GENM/GENP}

–î–∞–ª—ñ –º–æ–∂–µ—Ç–µ –Ω–∞–ø–∏—Å–∞—Ç–∏ —ñ–Ω—à—ñ —Ñ—É–Ω–∫—Ü—ñ—ó:

\begin{lstlisting}
# openssl cmp -cmd genm -server 127.0.0.1:1829 \
#             -recipient "/CN=CMPserver" -ref 1234 -secret pass:0000
\end{lstlisting}

\begin{lstlisting}
def message(_socket, _header, {:genm, req} = _body, _code) do
      :io.format 'generalMessage: ~p~n', [req]
  end
\end{lstlisting}

\newpage
\subsubsection{IR/IP}

\begin{lstlisting}
# openssl cmp -cmd ir -server 127.0.0.1:1829 \
#             -path . -srvcert ca.pem -ref NewUser \
#             -secret pass:0000 -certout maxim.pem \
#             -newkey maxim.key -subject "/CN=maxim/O=SYNRC/ST=Kyiv/C=UA"
\end{lstlisting}

\begin{lstlisting}
 def message(_socket, _header, {:ir, req}, _) do
      :lists.map(fn {:CertReqMsg, req, sig, code} ->
         :io.format 'request: ~p~n', [req]
         :io.format 'signature: ~p~n', [sig]
         :io.format 'code: ~p~n', [code]
      end, req)
  end
\end{lstlisting}

\subsubsection{CR/CP}

\begin{lstlisting}
# openssl cmp -cmd cr -server 127.0.0.1:1829 \
#             -path . -srvcert ca.pem -ref NewUser \
#             -secret pass:0000 -certout maxim.pem \
#             -newkey maxim.key -subject "/CN=maxim/O=SYNRC/ST=Kyiv/C=UA"
\end{lstlisting}

\newpage
\subsubsection{–í–∏—Å–Ω–æ–≤–∫–∏}

\begin{lstlisting}
defmodule CA do
  use Application
  use Supervisor

  require Record
  Enum.each(Record.extract_all(from_lib: "ca/include/PKIXCMP-2009.hrl"),
            fn {name, definition} -> Record.defrecord(name, definition) end)

  Enum.each(Record.extract_all(from_lib: "public_key/include/public_key.hrl"),
            fn {name, definition} -> Record.defrecord(name, definition) end)

  def init([]), do: {:ok, { {:one_for_one, 5, 10}, []} }
  def start(_type, _args) do
      :logger.add_handlers(:ldap)
      CA.CMP.start
      CA.CMC.start
      :supervisor.start_link({:local, __MODULE__}, __MODULE__, [])
  end
\end{lstlisting}

–ù—É PasswordBasedMac –≤ –Ω–∞—Å —î, —Ç–µ–ø–µ—Ä —Ç—Ä–µ–±–∞ DHMac, –∞–ª–µ shared secret –º–æ–∂–Ω–∞ —ñ –≤ PBM –∑–∞—Å—É–Ω—É—Ç–∏. –Ñ —à–µ Proof Of Posession (POP) ‚Äî —Ç–∞–º –∑—Ä–∞–∑—É ECDSA verify. –Ø –¥–æ —Ä–µ—á—ñ –¥—É–º–∞—é –≤ CA —Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á—ñ –¥–ª—è –≤—Å—ñ—Ö –∫—Ä–∏–≤–∏—Ö, —ñ –∫–æ–ª–∏ —è –≤–∏—Å—Ç–∞–≤–ª—è—Ç–∏–º—É —Å–µ—Ä–≤—ñ—Å —Ç–æ —è –±—É–¥—É –≤–∏—Å—Ç–∞–≤–ª—è—Ç–∏ –π–æ–≥–æ –Ω–∞ N –ø–æ—Ä—Ç–∞—Ö —ñ N –∫–ª—é—á–∞—Ö, —â–æ–± –±—É–¥—å —è–∫–∏–π –∫–ª—ñ—î–Ω—Ç—Å—å–∫–∏–π TLS —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –ø—Ä–∏–π–º–∞–≤—Å—è —è–∫ —Ä—ñ–¥–Ω–∏–π! Chat üí¨ X.509 –¥–∞—î –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –≤–∏–±–∏—Ä–∞—Ç–∏ TLS —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –ø–æ –æ–±—Ä–∞–Ω–∏—Ö –∫—Ä–∏–≤–∏—Ö. –í–∏ –≤–∏–±–∏—Ä–∞—î—Ç–µ –ø—ñ–¥ —è–∫–∏–º–∏ –∫–ª—é—á–∞–º–∏ —Å—å–æ–≥–æ–¥–Ω—ñ –∑–∞—Ö–æ–¥–∏—Ç–∏. LDAP, MQTT, NS, CA ‚Äî –≤ –∫–æ–∂–Ω–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É —Å–≤–æ—ó N –ø–æ—Ä—Ç—ñ–≤ —ñ N —Å–µ—Ä–≤–µ—Ä–Ω–∏—Ö TLS —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç—ñ–≤. –ü–µ—Ä–µ–¥–±–∞—á–∞—î—Ç—å—Å—è —â–æ –ø–µ—Ä—à–∏–π —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç –≤–∏–¥–∞—î—Ç—å—Å—è DH –ø–æ TCP –∞ –ø–æ—Ç—ñ–º –∑—Ä–∞–∑—É –≤—Å—å–æ –ø–µ—Ä–µ—Ö–æ–¥–∏—Ç—å –≤ TLS —Ä–µ–∂–∏–º —ñ –≤—Å—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –≤–∂–µ –≤–∏–¥–∞—é—Ç—å—Å—è –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–ª—ñ—î–Ω—Ç—Å—å–∫–æ–≥–æ TLS. –ü—Ä–∏ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –∑—Ä–∞–∑—É –¥–æ—Å—Ç—É–ø–Ω–∏–π –≤ LDAP —è–∫—à–æ –∑–∞—Ö–æ—Ç—ñ–≤ –∑—Ä–æ–±–∏—Ç–∏ —Å–µ–±–µ –≤—ñ–¥–∫—Ä–∏—Ç–∏–º –¥–ª—è –ø–æ—à—É–∫—É. –ü—ñ—Å–ª—è —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –ø–æ—à—É–∫ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó —ñ —Ñ—Ä–µ–Ω–¥—É–≤–∞–Ω–Ω—è (–æ–±–º—ñ–Ω –∫–ª—é—á–∞–º–∏) —ñ –ø–æ—ó—Ö–∞–ª–∏ —á–∞—Ç –≤ –æ–±–≥–æ—Ä—Ç–∫–∞—Ö CAdES, CMS, ECDSA/AES ‚Äî –ª–µ–π–±–∏ –±—ñ–ª—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å –ü–Ü–î–ü–ò–°/–®–ò–§–†.

\section{–¶–µ–Ω—Ç—Ä–∏ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó CA, –ê–¶–°–ö, –¶–ó–û —Ç–∞ –û–ó–û}

\section{–ë–µ–∑–ø–µ—á–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–º–µ–Ω–Ω–∏—Ö —ñ–º–µ–Ω DNSSEC}

\newpage
\section{–°–∏—Å—Ç–µ–º–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞ LDAP}

–ü—Ä–æ–π—à–ª–æ 13 —Ä–æ–∫—ñ–≤ –∑ —Ç–æ–≥–æ —á–∞—Å—É —è–∫ –∫–æ–º–ø–∞–Ω—ñ—è SYNRC –≤–∏–ø—É—Å—Ç–∏–ª–∞ –±—É–ª–∞ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π –±—Ä–µ–Ω–¥–æ–≤–∞–Ω–∏–π LDAP Directory Server –Ω–∞ Erlang –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é MongoDB. –í–∑–∞–≥–∞–ª—ñ –±–∞–∑ —è–∫—ñ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å –ø—Ä–µ—Ñ—ñ–∫—Å–Ω–∏–π —ñ —Å—É—Ñ—ñ–∫—Å–Ω–∏–π –ø–æ—à—É–∫ –ø–æ B-Tree —Ç–∞–±–ª–∏—Ü—è–º –Ω–µ —Ç–∞–∫ –±–∞–≥–∞—Ç–æ, –≤ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Ü–µ —Å–∫–ª–∞–¥–Ω—ñ SQL —Ç–∞ MongoDB. –•–æ—á–∞ —Ç–∞–∫—ñ –±–∞–∑–∏ —è–∫ Mnesia, LMDB, BDB-–ø–æ—Ö—ñ–¥–Ω—ñ (RocksDB, LevelDB) –Ω–µ–º–∞—é—Ç—å –ø–æ–≤–Ω–æ—Ç–µ–∫—Å—Ç–æ–≤–æ–≥–æ –ø–æ—à—É–∫—É, —Ü–µ –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —à–ª—è—Ö–æ–º –ø–æ–≤–Ω–æ–≥–æ —Ç—Ä–∞–≤–µ—Ä—Å–∞, —â–æ –Ω–∞ —Ü–∏—Ö –±–∞–∑–∞—Ö –∑–∞–∑–≤–∏—á–∞–π –ø—Ä–∞—Ü—é—î —à–≤–∏–¥–∫–æ (—è–∫—à–æ –Ω–∞ –°), —ñ —à–µ —à–≤–∏–¥—à–µ —è–∫—à–æ –±–∞–∑–∞ –ø—ñ–¥—Ç—Ä–∏–º—É—î mmap (LMDB).

–ù–µ–ø–µ—Ä–µ–º–æ–∂–Ω–∏–π –ø–æ –ø–µ—Ä—Ñ–æ—Ä–º–µ–Ω—Å—É —Å—Ç–∞–Ω–æ–º –Ω–∞ –∑–∞—Ä–∞–∑ —î OpenLDAP (LMDB), –æ–¥–Ω–∞–∫ –Ω–∞–º —Ö–æ—á–µ—Ç—å—Å—è –º–∞—Ç–∏ —Å–≤–æ—é —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—é, —è–∫—É –º–æ–∂–Ω–∞ –±—É–ª–æ –±–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —è–∫ —Ñ—ñ—Ä–º–æ–≤–µ —Å—Ö–æ–≤–∏—â–µ –¥–∞–Ω–∏—Ö –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó —Ä–µ—Å—É—Ä—Å—ñ–≤ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞ –∑–≥—ñ–¥–Ω–æ —è–∫ –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏—Ö —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ —Ç–∞–∫ —ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—ñ–≤ –£–∫—Ä–∞—ó–Ω–∏. –ú–∏ –∑–∞—Ö–æ—Ç—ñ–ª–∏ –≤—ñ–¥–º–æ–≤–∏—Ç–∏—Å—è –≤—ñ–¥ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó –±–∞–∑–∏ –¥–∞–Ω–∏—Ö (MongoDB) —â–æ —É—Å–∫–ª–∞–¥–Ω—é—î —Ä–æ–∑—Ä–æ–±–∫—É, —ñ —Ö–æ—Ç—ñ–ª–æ—Å—è –≤–∏–±—Ä–∞—Ç–∏ —à–æ—Å—å –≤–±—É–¥–æ–≤—É–≤–∞–Ω–µ –¥–ª—è Erlang, –≤–∏–±–∏—Ä–∞–ª–∏ –º—ñ–∂ zambal/elmdb —Ç–∞ elixir-sqlite/exqlite, –ø–µ—Ä–µ–º—ñ–≥ SQLite —Ç–æ–º—É —à–æ —Ö–æ—Ç—ñ–ª–æ—Å—è –º–∞—Ç–∏ –º—ñ–Ω—ñ–º–∞–ª—å–Ω—É —ñ–¥—ñ–æ–º–∞—Ç–∏—á–Ω—É —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—é, —Ç–∞–∫–∞ —à–æ–± –∑ –æ–¥–Ω–æ–≥–æ –±–æ–∫—É –±—É–ª–∞ –∑—Ä–æ–∑—É–º—ñ–ª–∞ –Ω–∞–≤—ñ—Ç—å –ª—é–¥—è–º –±–µ–∑ –≥–ª–∏–±–æ–∫–æ—ó –æ—Å–≤—ñ—Ç–∏ –≤ Computer Science, –∞ –∑ —ñ–Ω—à–æ–≥–æ –±–æ–∫—É –≤—ñ–¥–∫—Ä–∏–≤–∞–ª–∞ –¥–≤–µ—Ä—ñ –≤ –ø—ñ–¥—Ç—Ä–∏–º–∫—É —ñ–Ω—à–∏—Ö –ø—Ä–æ–º–∏—Å–ª–æ–≤–∏—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∏—Ö SQL –¥–∂–µ—Ä–µ–ª –¥–∞–Ω–∏—Ö (Oracle, T-SQL, PostgreSQL).

–ù–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –≤–µ—Ä—Å—ñ—ó SYNRC LDAP —è–∫–∞ —Ä–æ–±–∏–ª–∞—Å—è –ø—ñ–¥ —Å—Ç–∞—Ä—Ç–∞–ø PEOPLE|SYNC —è–∫–∏–π –º–∏ —Ö–æ—Ç—ñ–ª–∏ –ø—Ä–æ–¥–∞—Ç–∏ PEOPLE|NET, –∞ –ø–æ—Ç—ñ–º –ö–∏—ó–≤—Å—Ç–∞—Ä, —è–∫ SyncML —Å—Ç–∞—Ä—Ç–∞–ø –ø–æ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑–∞—Ü—ñ—ó –∫–æ–Ω—Ç–∞–∫—Ç–Ω–∏—Ö –∫–Ω–∏–≥, —Ü—è –≤–µ—Ä—Å—ñ—è —Ä–æ–±–∏—Ç—å—Å—è –¥–ª—è —Å—Ç–∞—Ä—Ç–∞–ø–∞ SYNRC CHAT –¥–ª—è —Ä–æ–∑–≤—ñ–¥–∫–∏. –í —Ü—ñ–π –≤–µ—Ä—Å—ñ—ó –º–∏ –∑–Ω–∞—á–Ω—É —É–≤–∞–≥—É –ø—Ä–∏–¥—ñ–ª–∏–ª–∏ —Å—É–º—ñ—Å–Ω—ñ—Å—Ç—é –∑ –∫–ª—ñ—î–Ω—Ç–∞–º–∏, —Ç–∞–∫–∏–º–∏ —è–∫ Apache Directory Studio, –∞ —Ç–∞–∫–æ–∂ —É—Å—ñ–º–∞ LDIF —Ñ–∞–π–ª–∞–º–∏ —è–∫—ñ –º–∏ –∑–º–æ–≥–ª–∏ –∑–Ω–∞–π—Ç–∏ –≤ —ñ–Ω—Ç–µ—Ä–Ω–µ—Ç—ñ.

–¢–∞–∫ —è–∫ —è–∫—ñ—Å–Ω—É –±–µ–∑–ø–µ—á–Ω—É —Ä–æ–∑–ø–æ–¥—ñ–ª–µ–Ω—É —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—É —è–∫–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –º—ñ–∂–Ω–∞—Ä–æ–¥–Ω–∏–º —ñ —É–∫—Ä–∞—ó–Ω—Å—å–∫–∏–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∞–º–∏ –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –±–µ–∑ CA/CMS, OCSP, TSP, LDAP, DNS/DNSSEC, MQTT —Å–µ—Ä–≤–µ—Ä—ñ–≤, —Ç–æ –≤—Å—ñ —Ü—ñ —Å–µ—Ä–≤–µ—Ä–∏ —î —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç–æ–º –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ SYNRC —è–∫—ñ —Ñ–æ—Ä–º—É—é—Ç—å –ø–µ—Ä—à–∏–π —Ä—ñ–≤–µ–Ω—å —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É –°–æ—Ö–∞—Ü—å–∫–æ–≥–æ —è–∫–∏–π —É–º–æ–≤–Ω–æ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è Security –∞–±–æ –ë–µ–∑–ø–µ–∫–∞ –ü—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞. –ù–∞ —Ü—å–æ–º—É —Ñ—Ä–µ–π–º–≤–æ—Ä–∫—É –ø–æ–±—É–¥–æ–≤–∞–Ω—ñ –≥–æ–ª–æ–≤–Ω—ñ —ñ–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –∫—Ä–∞—ó–Ω–∏, –∞ —Ç–∞–∫–æ–∂ —Ä–µ—î—Å—Ç—Ä–æ–≤—ñ —Å–∏—Å—Ç–µ–º–∏.

–ó–∞–≥–∞–ª–æ–º, LDAP —Ü–µ –¥—É–∂–µ –¥—Ä–µ–≤–Ω—è —ñ –Ω–∞–¥—ñ–π–Ω–∞ —Ç–µ—Ö–Ω–æ–ª–æ–≥—ñ—è —è–∫–∞ –ø—Ä–∏—Å—É—Ç–Ω—è –±—É–∫–≤–∞–ª—å–Ω–æ —É –≤—Å—ñ—Ö —Ç–æ–ø–æ–≤–∏—Ö –∫–æ–º–ø–∞–Ω—ñ—è—Ö, –∫–æ—Ä–ø–æ—Ä–∞—Ü—ñ—è—Ö, –≤–µ–ª–∏–∫–∏—Ö —ñ –º–∞–ª–∏—Ö –±—ñ–∑–Ω–µ—Å–∞—Ö. –¢–∞–∫, —î —Å—É—á–∞—Å–Ω—ñ–π Identity Server –ø—Ä–æ–¥—É–∫—Ç–∏ (Hashicorp) —è–∫—ñ –Ω–µ –ø—ñ–¥—Ç—Ä–∏–º—É—é—Ç—å—Å—è LDAP, –∞–ª–µ —Ü–µ –ø–æ–æ–¥–∏–Ω–æ–∫—ñ –Ω–µ–ø–æ–ø—É–ª—è—Ä–Ω—ñ –º–∞—Ä–≥—ñ–Ω–∞–ª—å–Ω—ñ –µ–∫–∑–µ–º–ø–ª—è—Ä–∏. SYNRC LDAP —Ü–µ –≥–∞—Ä–Ω–∏–π –ø–æ—á–∞—Ç–æ–∫ –¥–ª—è –º–∞–ª–∏—Ö, —Å–µ—Ä–µ–¥–Ω—ñ—Ö —ñ –≤–µ–ª–∏–∫–∏—Ö –±—ñ–∑–Ω–µ—Å—ñ–≤ –Ω–∞–≤–µ—Å—Ç–∏ –ø–æ—Ä—è–¥–æ–∫ –≤ —à—Ç–∞—Ç–Ω–∏—Ö —Ä–æ–∑–∫–ª–∞–¥–∞—Ö, –∫–∞–ª–µ–Ω–¥–∞—Ä—è—Ö, –∑–∞–¥–∞—á–∞—Ö, —Ä–µ—Å—É—Ä—Å–∞—Ö –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞, —Ç–∞–∫–∏—Ö —è–∫ –∞–≤—Ç–æ–ø–∞—Ä–∫–∏, IoT, —Ä–µ—î—Å—Ç—Ä–∞—Ö –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∏—Ö —ñ –ø—Ä–æ–º–∏—Å–ª–æ–≤–∏—Ö –∫–æ–º–ø'—é—Ç–µ—Ä—ñ–≤, –ø–æ—Ä—Ç—ñ–≤, –ø—Ä–∞–≤–∏–ª ABAC, –ø—Ä–∞–≤–∏–ª –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü—ñ—ó, –∫–æ–Ω—Ç–∞–∫—Ç–Ω–∏—Ö –∫–Ω–∏–≥–∞—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤, –æ–¥–Ω–∏–º —Å–ª–æ–≤–æ–º –≤—Å–µ –¥–ª—è —á–æ–≥–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π —ñ –¥–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è LDAP.

\subsection{–í–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ –±–∞–∑–∏}

–Ø –≤–ø–µ—Ä—à–µ –ø–æ–∑–Ω–∞–π–æ–º–∏–≤—Å—è –∑ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏–º–∏ –±–∞–∑–∞–º–∏ –∫–æ–ª–∏ –ø—Ä–∞—Ü—é–≤–∞–≤ –≤ International Land Systems, Inc. –¢–æ–¥—ñ –≤ –Ω–∞—Å –±—É–ª–∞ —Å–∏—Å—Ç–µ–º–∞ –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±—ñ–≥—É –Ω–∞ –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω—ñ–π –±–∞–∑—ñ, —è–∫—ñ –¥—É–∂–µ —á–∞—Å—Ç–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≤ —Å–∏—Å—Ç–µ–º–∞—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–æ–±—ñ–≥—É. –ù–∞–ø—Ä–∏–∫–ª–∞–¥ —Ç–∞–∫—É —Å—Ö–µ–º—É –¥–∞–Ω–∏—Ö –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Alfresco, –∞ —Ç–∞–∫–æ–∂ SQL —Ä–æ–∑—à–∏—Ä–µ–Ω–Ω—è –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è XML —É Oracle —Ç–∞ —ñ–Ω—à–∏—Ö SQL –±–∞–∑–∞—Ö.

–û—Å–Ω–æ–≤–Ω–∞ —ñ–¥–µ—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏—Ö –±–∞–∑, –∞–±–æ —Å—Ö–µ–º, –ø–æ–ª—è–≥–∞—î –≤ —Ç–æ–º—É —à–æ –æ–±'—î–∫—Ç–∏ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –Ω–µ —É –ø–ª–æ—Å–∫–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö –¥–µ –∫–æ–∂–µ–Ω –∞—Ç—Ä–∏–±—É—Ç —Ü–µ –æ–∫—Ä–µ–º–∞ –∫–æ–ª–æ–Ω–∫–∞, –∞ –≤—Å—ñ –∞—Ç—Ä–∏–±—É—Ç–∏ —Ç–∞ —ó—Ö –∑–Ω–∞—á–µ–Ω–Ω—è –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è –≤ —Ç—Ä—å–æ—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö, –¥–µ –ø–µ—Ä—à–∞ ‚Äî —Ü–µ –Ω–æ–º–µ—Ä –æ–±'—î–∫—Ç–∞, –¥—Ä—É–≥–∞ ‚Äî —ñ–º'—è –∞—Ç—Ä–∏–±—É—Ç–∞, –∞ —Ç—Ä–µ—Ç—è ‚Äî –∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ç—Ä–∏–±—É—Ç—É. –¶–µ –¥–æ–∑–≤–æ–ª—è—î —Ç—Ä–∏–º–∞—Ç–∏ —Ä–æ–∑—Ä—ñ–∂–µ–Ω—ñ (–∞—Ç—Ä–∏–±—É—Ç–∞–º–∏) –æ–±'—î–∫—Ç–∏, —Ç–∞ –ø–µ–≤–Ω–∏–º —á–∏–Ω–æ–º —Å–ø—Ä–æ—Å—Ç–∏—Ç–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –±–∞–∑–æ—é. –í—Å—ñ –Ω–∞—ó–≤–Ω—ñ —ñ–º–ø–ª–µ–º–µ–Ω—Ç–∞—Ü—ñ—ó –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–∏—Ö –±–∞–∑ —Å—Ç—Ä–∞–∂–¥–∞—é—Ç—å—Å—è –ø–æ –ø–µ—Ä—Ñ–æ—Ä–º–µ–Ω—Å—É, —Ç–æ–º—É –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—É—Ç–∏ –æ–±—Ä–µ–∂–Ω–∏–º. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, –º–∏ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É—î–º–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ SYNRC LDAP –¥–µ –æ–±'—î–º –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î –±—ñ–ª—å—à–µ –Ω—ñ–∂ –ø—ñ–≤ –º—ñ–ª—å–π–æ–Ω–∞ —Å–ø—ñ–≤—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ –¥–ª—è Walmart. –î–ª—è –≤–µ–ª–∏–∫–∏—Ö –∫–æ—Ä–ø–æ—Ä–∞—Ü—ñ–π –∫—Ä–∞—â–µ –±—Ä–∞—Ç–∏ OpenLDAP.

\subsection{–ü—Ä–µ–¥–º–µ—Ç–Ω–∞ –æ–±–ª–∞—Å—Ç—å}

\subsubsection{Netscape, Sun DS, 389 DS, Oracle}

PEOPLE|SYNC —Å—Ç–∞—Ä—Ç–∞–ø SYNRC 2007 —Ä–æ–∫—É –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞–≤ —Ç–∞–∫–æ–∂ —Ä–æ–±–æ—Ç—É –∑ Sun Directory Server. –ô–æ–≥–æ —Ä–æ–¥–æ–≤—ñ–¥ –±–µ—Ä–µ –ø–æ—á–∞—Ç–æ–∫ –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞ OpenLDAP, –≤ 1996 —Ä–æ–∫—É —Å—Ç–∞—Ä—Ç—É–≤–∞–≤ —Ñ–æ—Ä–∫ Netscape Directory Server. –ü—ñ—Å–ª—è –±–∞–Ω–∫—Ä–æ—Ç—Å—Ç–≤–∞ Netscape –ø—Ä–∞–≤–æ –Ω–∞ –∫–æ–¥ –≤–∏–∫—É–ø–∏–ª–∞ –∫–æ–º–ø–∞–Ω—ñ—è AOL, —è–∫–∞ –ª—ñ—Ü–µ–Ω–∑—É–≤–∞–ª–∞ –ø—Ä–∞–≤–æ –Ω–∞ —Ä–æ–∑—Ä–æ–±–∫—É –∫–æ–º–ø–∞–Ω—ñ—ó Sun Microsystems, –∑–±–µ—Ä—ñ–≥—à–∏ –ø—Ä–∞–≤–æ –Ω–∞ –∫–æ–¥. –í 2009 —Ä–æ—Ü—ñ Sun DS –±—É–≤ –ø–µ—Ä–µ—ñ–º–µ–Ω–æ–≤–∞–Ω–∏–π –Ω–∞ 389 Directory Server, –∞ Oracle –ø–æ—á–∞–ª–∞ —Å–≤—ñ–π —Ñ–æ—Ä–∫ Sun DS –ø—ñ–¥ –Ω–∞–∑–≤–æ—é Oracle Directory Server. 389 Directory Server —Ç–∞–∫–æ–∂ –º–æ–∂–Ω–∞ –∑—É—Å—Ç—Ä—ñ—Ç–∏ –ø—ñ–¥ —ñ–º–µ–Ω–∞–º–∏ Fedora DS —Ç–∞ Red Hat DS, –æ—Å–∫—ñ–ª—å–∫–∏ —Ü–µ –æ—Å–Ω–æ–≤–Ω—ñ –¥–æ–Ω–æ—Ä–∏ –ø—Ä–æ–µ–∫—Ç—É.

\subsubsection{Microsoft Active Directory}

–¢—Ä–∞–¥–∏—Ü—ñ–π–Ω–æ –∫–æ–∂–Ω–∞ –∫–æ—Ä–ø–æ—Ä–∞—Ü—ñ—è –∑–∞–π–º–∞—î—Ç—å—Å—è —Ä–æ–∑—Ä–æ–±–∫–æ—é —Å–≤–æ–≥–æ LDAP —Å–µ—Ä–≤–µ—Ä–∞, –∫–æ–º–ø–∞–Ω—ñ—è Microsoft –≤–∏–ø—É—Å—Ç–∏–ª–∞ —Å–≤—ñ–π –ø–µ—Ä—à–∏–π –≤ 1999 —Ä–æ—Ü—ñ. Active Directory —É —è–∫–æ—Å—Ç—ñ –±–µ–∫–µ–Ω–¥–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î Extensible Storage Engine ESENT.DLL, —Ç–∞–∫–æ–∂ –≤—ñ–¥–æ–º–∏–π —è–∫ JetDB, –Ω–∞ —è—Ü—ñ–π –ø–æ–±—É–¥–æ–≤–∞–Ω–∏–π —Ç–∞–∫–æ–∂ Windows Registry, Microsoft Access, —Ç–∞ –º–æ–∂–ª–∏–≤–æ —ñ —ñ–Ω—à—ñ –≤–Ω—É—Ç—Ä—ñ—à–Ω—ñ –ø—Ä–æ–¥—É–∫—Ç–∏ –∫–æ–º–ø–∞–Ω—ñ—ó Microsoft.

\subsubsection{OpenLDAP, Apple Open Directory}

–ë—É–ª–∏ —á–∞—Å–∏, —â–æ OpenLDAP –±—É–≤ –≤–±—É–¥–æ–≤–∞–Ω–∏–π –≤ –∫–æ–∂–Ω—É –≤–µ—Ä—Å—ñ—é Mac OS X, –∞–ª–µ Apple –ø–æ—á–∞–ª–∞ —Ä–æ–∑–≤–∏–≤–∞—Ç–∏ —Å–≤—ñ–π –≤–ª–∞—Å–Ω–∏–π Open Directory Server, –æ—Å–∫—ñ–ª—å–∫–∏ –±–µ–∑–ø–µ–∫–∞ –∫–æ–∂–Ω–æ—ó –∫–æ—Ä–ø–æ—Ä–∞—Ü—ñ—ó –ø–æ–ª—è–≥–∞—î —É —Ç–æ–º—É —á–∏—Å–ª—ñ –≤ –±—Ä–µ–Ω–¥–æ–≤–∞–Ω–∏—Ö LDAP —Å–µ—Ä–≤–µ—Ä–∞—Ö –ø—ñ–¥ —Å–≤–æ—ó –ø–æ—Ç—Ä–µ–±–∏ —Ç–∞ –ø–æ–ª—ñ—Ç–∏–∫—É —Ä–æ–∑—Ä–æ–±–∫–∏..

\subsection{TCP —Å–µ—Ä–≤–µ—Ä}

–Ø –Ω–µ–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤ –Ω–∞–ø–∏—Å–∞–Ω–Ω—è LDAP —Å–µ—Ä–≤–µ—Ä—É —É —Å–≤–æ—ó—Ö Erlang –∫—É—Ä—Å–∞—Ö, –∞ —Ç–∞–∫–æ–∂ –Ω–∞ –∫–æ–Ω—Ñ–µ—Ä–µ–Ω—Ü—ñ—è—Ö —É —è–∫–æ—Å—Ç—ñ –º–∞–π—Å—Ç–µ—Ä-–∫–ª–∞—Å—É –ø–æ –ø—Ä–æ–≥—Ä–∞–º—É–≤–∞–Ω–Ω—é, –¥–µ –º–∏ –∑ –∞—É–¥–∏—Ç–æ—Ä—ñ—î—é –ø–∏—à–µ–º–æ –≤—Å—ñ —Ä–∞–∑–æ–º LDAP —Å–µ—Ä–≤–µ—Ä –∑–∞ 45 —Ö–≤–∏–ª–∏–Ω –∑ –º–æ—ó–º–∏ –∫–æ–º–µ–Ω—Ç–∞—Ä—è–º–∏ —Ç–∞ —ñ–Ω—Ç–µ—Ä–∞–∫—Ü—ñ—î—é. –†–µ–∫–æ—Ä–¥ –Ω–∞ –≤—ñ–¥–µ–æ –±—É–≤ –ø–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–π 30 —Ö–≤–∏–ª–∏–Ω, —Ç–∞–∫ —à–æ —Ü–µ –Ω–µ –ø—Ä—ñ–∫–æ–ª, —è –¥—ñ–π—Å–Ω—é MVP –≤—Å—ñ—Ö –ø—Ä–æ–¥—É–∫—Ç—ñ–≤ SYNRC –º–æ–∂—É –Ω–∞–ø–∏—Å–∞—Ç–∏ –∑–∞ 30 —Ö–≤–∏–ª–∏–Ω –∫–æ–∂–µ–Ω. –í–ª–∞—Å–Ω–µ —Ü–µ —î –æ–¥–Ω–∏–º –∑ –∫—Ä–∏—Ç–µ—Ä—ñ—ó–≤ SYNRC, —â–æ —Ç—ñ—Å–Ω–æ –ø–µ—Ä–µ–ø–ª–µ—Ç–µ–Ω–æ –∑ –ø–æ–∫–∞–∑–Ω–∏–∫–æ–º LOC. –¶—è –≤–µ—Ä—Å—ñ—è SYNRC LDAP –∑ –ø—ñ–¥—Ç—Ä–∏–º–∫–æ—é SQLite –∑–∞–π–º–∞—î 300 —Ä—è–¥–∫—ñ–≤ –∫–æ–¥—É —ñ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å –≤—Å—ñ LDIF —Ç–µ—Å—Ç —Å—é—ó—Ç–∏.

–ü–µ—Ä–µ–¥ –ø–æ—á–∞—Ç–∫–æ–º –ø–æ—Å—Ç–∞–≤—Ç–µ Erlang —Ç–∞ –π–æ–≥–æ Erlang AST —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ Elixir. –°—Ç–∞–≤–∏—Ç–∏ –º–æ–∂–Ω–∞ –∑–∞–≤–∂–¥–∏ —Ç—ñ–ª—å–∫–∏ Elixir, Erlang –ø—ñ–¥–µ —è–∫ –∑–∞–ª–µ–∂–Ω—ñ—Å—Ç—å –≤ –±—É–¥—å-—è–∫–æ–º—É –ø–µ–∫–µ–¥–∂ –º–µ–Ω–µ–¥–∂–µ—Ä—ñ.

\begin{lstlisting}
# apt install elixir
\end{lstlisting}

–°—Ç–≤–æ—Ä—é—î–º–æ –ø–∞–ø–∫—É –ø—Ä–æ–µ–∫—Ç—É —ñ –≤ –Ω—ñ–π —Å—Ç–≤–æ—Ä—é—î–º–æ —Ñ–∞–π–ª mix.exs –¥–ª—è —É–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–æ–≥–æ –¥–µ–ø–µ–Ω–¥–µ–Ω—Å—ñ —ñ –ø–µ–∫–∞–¥–∂ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ Erlang —ñ Elixir –º–æ–≤, mix.

–ö—Ä—ñ–º –∫–ª–∞—Å–∏—á–Ω–æ—ó –ø—Ä–µ–ª—é–¥—ñ—ó mix.exs, –Ω–∞–º —Ü—ñ–∫–∞–≤–∏–π –ø–∞—Ä–∞–º–µ—Ç—Ä exqlite, —Ü–µ —ñ–º'—è –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ hex.pm, —è–∫–∞ –º—ñ—Å—Ç–∏—Ç—å –≤ —Å–æ–±—ñ 8-–º–µ–≥–∞–±–∞–π—Ç–Ω–∏–π –°—ñ —Ñ–∞–π–ª, —ñ FFI –æ–±–≥–æ—Ä—Ç–∫—É –¥–ª—è –Ω—å–æ–≥–æ —è–∫–∞ –≤ Erlang —Å–≤—ñ—Ç—ñ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è NIF.

\begin{lstlisting}
defmodule LDAP.Mixfile do
  use Mix.Project
  def project(), do:
    [ app: :ldap, version: "8.7.20", deps: deps(),
      releases: [ ldap: [ include_executables_for: [:unix],
                          cookie: "SYNRC:LDAP" ] ] ]
  def application(), do:
    [ mod: {LDAP, []},
      extra_applications: [ :eldap, :asn1 ] ] end
  def deps(), do:
    [ {:exqlite, "~> 0.13.14"} ]
end
\end{lstlisting}

–î–∞–ª—ñ –ø–∏—à–µ–º–æ –Ω–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π —ñ–¥—ñ–æ–º–∞—Ç–∏—á–Ω–∏–π Erlang TCP —Å–µ—Ä–≤–µ—Ä. –î–æ–≤–≥–∏–π —á–∞—Å —è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–≤ –∫–ª–∞—Å–∏—á–Ω—ñ, —Ä–æ–∑—à–∏—Ä–µ–Ω—ñ –≤–µ—Ä—Å—ñ—ó –Ω–∞ –Ω–µ–¥–æ–∫—É–º–µ–Ω—Ç–æ–≤–∞–Ω—ñ–π —Ñ—É–Ω–∫—Ü—ñ—ó prim_inet:async_accept, —Ç–∞–∫–∏–π —è–∫ 5HT/tcp, –∞–ª–µ –∑—Ä–µ—à—Ç–æ—é –≤—ñ–¥–º–æ–≤–∏–≤—Å—è —Ç–∞–∫ —è–∫ –Ω–µ –≤–±–∞—á–∞—é –≤ –Ω–∞–¥–º—ñ—Ä–Ω–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª—ñ —Å–µ–º–∞–Ω—Ç–∏–∫–∏ –ø—Ä–æ—Ü–µ—Å—É –Ω—ñ—è–∫–∏—Ö –ø–µ—Ä–µ–≤–∞—Ö, –¥–ª—è –Ω–∞—Å –¥—ñ—î —Ç–∞–∫–∞ —Å–∞–º–∞ —Å–µ–º–∞–Ω—Ç–∏–∫–∞ —è–∫ –≤ –≤–µ–±—ñ, –≤—ñ–¥–≤–∞–ª–∏–≤—Å—è –∫–ª—ñ—î–Ω—Ç —ñ –Ω—ñ—á–æ–≥–æ —Å—Ç—Ä–∞—à–Ω–æ–≥–æ, –Ω—ñ–∫–æ–º—É –π–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞ —Ä—ñ–≤–Ω—ñ —Å–∏–≥–Ω–∞–ª—ñ–Ω–≥—É –Ω–µ –ø–æ—Ç—Ä—ñ–±–µ–Ω. –ú–∏ –Ω–µ —Å–ª—ñ–¥–∫—É—î–º–æ –∑–∞ LDAP –∫–ª—ñ—î–Ω—Ç–∞–º–∏!

–Ø–∫—à–æ –≤ config/config.exs –Ω–µ–º–∞—î –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ ldap:intance —Ç–æ —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –Ω–æ–≤–∞ SQLite –±–∞–∑–∞ –ø–æ —Ä–µ–Ω–¥–æ–º–Ω–æ–º—É —Ö–µ—à—É –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏ –ø–æ –ø–µ—Ä—Ñ–æ—Ä–º–∞–Ω—Å—É: 1) –≤—ñ–¥–∫–ª—é—á–µ–Ω–∏–π –∂—É—Ä–Ω–∞–ª, 2) —ñ–Ω-–º–µ–º–æ—Ä—ñ –±—É—Ñ–µ—Ä, 3) –≤–µ–ª–∏–∫–∏–π –∫–µ—à, 4) –ø—Ä–∏–º—É—Å–æ–≤–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ñ—Å—Ç—å; —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å—Å—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º–∏ SQL –ø—Ä–∞–≥–º–∞–º–∏.

–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞ TCP —Å–µ—Ä–≤–µ—Ä–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î POSIX, –º–∏ —Å—Ç–≤–æ—Ä—é—î–º–æ –ª—ñ—Å—Ç–µ–Ω–µ—Ä, —è–∫–∏–π –Ω–∞ –∫–æ–∂–Ω–µ –≤—Ö—ñ–¥–Ω–µ TCP –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —Å—Ç–∞—Ä—Ç—É—î –∞–∫—Ü–µ–ø—Ç–æ—Ä–∏, —è–∫—ñ —Å—Ç–∞—Ä—Ç—É—é—Ç—å –Ω–µ–∫–æ—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–∏–π Erlang –ø—Ä–æ—Ü–µ—Å ‚Äî –ª—É–ø–µ—Ä, —è–∫–∏–π –æ–±—Å–ª—É–≥–æ–≤—É—î –≤—Ö—ñ–¥–Ω–µ TCP –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –î–ª—è –¥–µ–∫–æ–¥—É–≤–∞–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π ASN.1 –∫–æ–º–ø—ñ–ª—è—Ç–æ—Ä–æ–º –µ–Ω–∫–æ–¥–µ—Ä/–¥–µ–∫–æ–¥–µ—Ä LDAP –ø—Ä–æ—Ç–æ–∫–æ–ª—É –ø–æ —Ñ–∞–π–ª—É LDAP.ans1, —è–∫–∏–π –º–æ–∂–Ω–∞ –∑–Ω–∞–π—Ç–∏ –ø—Ä—è–º–æ –≤ RFC IETF –Ω–∞ –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–æ-–ø—Ä–∞–≤–æ–≤–∏—Ö –∞–∫—Ç–∞—Ö –£–∫—Ä–∞—ó–Ω–∏.

\begin{lstlisting}
# erlc LADP.asn1
–ü—ñ—Å–ª—è –≥–µ—Ä–µ–Ω–∞—Ü—ñ—ó –ø–æ–∫–ª–∞–¥—ñ—Ç—å —Ñ–∞–π–ª–∏ –≤ LDAP.erl —Ç–∞ LDAP.hrl –≤ –ø–∞–ø–∫—É src –ø—Ä–æ–µ–∫—Ç—É. –ê –≤ –ø–∞–ø—Ü—ñ lib —Å—Ç–≤–æ—Ä—ñ—Ç—å –æ–±–≥–æ—Ä—Ç–∫—É –¥–ª—è –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏—Ö —Ä–µ–∫–æ—Ä–¥—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Record,
\end{lstlisting}

\begin{lstlisting}
defmodule DS do
    require Record
    Enum.each(Record.extract_all(from_lib: "ldap/include/LDAP.hrl"),
             fn {name, definition} -> Record.defrecord(name, definition) end)
end
\end{lstlisting}

–∞ —Ç–∞–∫–æ–∂ —Å—Ç–≤–æ—Ä—ñ—Ç—å –∫–æ–∑—É Erlang –∞–ø–ª—ñ–∫–µ–π—à–∏–Ω–∞ –≤ Elixir —Å–∏–Ω—Ç–∞–∫—Å–∏—Å—ñ, —Ñ–∞–π–ª ldap.ex:

\begin{lstlisting}
defmodule LDAP do
   import Exqlite.Sqlite3
   require DS
   use Application
   use Supervisor

   def code(), do: :binary.encode_hex(:crypto.strong_rand_bytes(8))
   def init([]), do: {:ok, { {:one_for_one, 5, 10}, []} }
   def start(_, _) do
       :logger.add_handlers(:ldap)
       :supervisor.start_link({:local, LDAP}, LDAP, [])
   end

   def initDB(path) do
       {:ok, conn} = open(path)
       :logger.info 'SYNRC LDAP Instance: ~p', [path]
       :logger.info 'SYNRC LDAP Connection: ~p', [conn]
       execute(conn, "create table ldap (rdn text,att text,val binary)")
       :ok = execute(conn, "PRAGMA journal_mode = OFF;")
       :ok = execute(conn, "PRAGMA temp_store = MEMORY;")
       :ok = execute(conn, "PRAGMA cache_size = 1000000;")
       :ok = execute(conn, "PRAGMA synchronous = 0;")
       conn
   end

\end{lstlisting}

\begin{lstlisting}

   def listen(port,path) do
       conn = initDB(path)
       {:ok, socket} = :gen_tcp.listen(port,
         [:binary, {:packet, 0}, {:active, false}, {:reuseaddr, true}])
       accept(socket,conn)
   end

   def accept(socket,conn) do
       {:ok, fd} = :gen_tcp.accept(socket)
       :erlang.spawn(fn -> loop(fd, conn) end)
       accept(socket,conn)
   end

   def start() do
       :erlang.spawn(fn ->
           listen(:application.get_env(:ldap,:port,1489),
                  :application.get_env(:ldap,:instance,code())) end)
   end

    def answer(response, no, op, socket) do
        message = DS."LDAPMessage"(messageID: no, protocolOp: {op, response})
        {:ok, bytes} = :'LDAP'.encode(:'LDAPMessage', message)
        send = :gen_tcp.send(socket, :erlang.iolist_to_binary(bytes))
    end

   def loop(socket, db) do
       case :gen_tcp.recv(socket, 0) do
            {:ok, data} ->
                 case :'LDAP'.decode(:'LDAPMessage',data) do
                      {:ok,decoded} ->
                          {:'LDAPMessage', no, payload, _} = decoded
#                         message(no, socket, payload, db)
                          loop(socket, db)
                      {:error,reason} ->
                         :logger.error 'ERROR: ~p', [reason]
                        :exit
                 end
            {:error, :closed} -> :exit
       end
   end
end
\end{lstlisting}

–¶–µ–π —Å–µ—Ä–≤–µ—Ä –≤–∂–µ –º–æ–∂–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏ –Ω–∞ –∑–∞–ø–∏—Ç–∏ ldapmodify –∞–ª–µ –±—É–¥–µ —ó—Ö –±–ª–æ–∫—É–≤–∞—Ç–∏ —Ç–∞–∫ —è–∫ –ø–æ–∫–∏ —â–æ –Ω–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –Ω–∞–ª–µ–∂–Ω–∏–º —á–∏–Ω–æ–º. –ó–∞–ø—É—Å—Ç–∏—Ç–∏ –ø—Ä–æ–≥—Ä–∞–º—É –º–æ–∂–Ω–∞ –∫–ª–∞—Å–∏—á–Ω–∏–º–∏ –º–∞–Ω—Ç—Ä–∞–º–∏ Elixir, –∞ –≤ Elixir Shell –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ—é –∑–∞–ø—É—Å–∫—É TCP –ª—ñ—Å—Ç–µ–Ω–µ—Ä–∞, –¥–ª—è —Ü—å–æ–≥–æ –ø–µ—Ä–µ–≤–ø–µ–≤–Ω—ñ—Ç—å—Å—è —â–æ –¥–µ—Ñ–∞—É–ª—Ç–Ω–∏–π –ø–æ—Ä—Ç 1389 –≤—ñ–ª—å–Ω–∏–π.

\begin{lstlisting}
$ mix deps.get
$ iex -S mix
> LDAP.start
#PID<0.311.0>
iex(2)>
04:58:26.030 [info]  SYNRC LDAP Instance: "416C4C41ED2C7060"
04:58:26.030 [info]  SYNRC LDAP Connection: #Reference<0.1146704550.396492828.212314>
iex(3)>
nil
\end{lstlisting}

\newpage
\subsubsection{BIND}

–î–ª—è —É–¥–∞—á–Ω–æ–≥–æ –¥–µ–º–æ —è —Ä–∞–¥–∂—É –ø–æ—á–∏–Ω–∞—Ç–∏ –∑ —Ñ—É–Ω–∫—Ü—ñ—ó BIND. –î–ª—è —Ü—å–æ–≥–æ —Å—Ç–≤–æ—Ä–∏–º–æ –≤ –±–∞–∑—ñ –∑–∞–ø–∏—Å–∏ –ø–æ —è–∫–∏–º –±—É–¥–µ–º–æ –∞—É—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫—É–≤–∞—Ç–∏—Å—è.

\begin{lstlisting}
  createDN(conn, "dc=synrc,dc=com",
      [ attr("dc",["synrc"]),
        attr("objectClass",["top","domain"]) ])
  createDN(conn, "ou=schema",
      [ attr("ou",["schema"]),
        attr("objectClass",["top","domain"]) ])
  createDN(conn, "cn=tonpa,dc=synrc,dc=com",
      [ attr("cn",["tonpa"]),attr("uid",["1000"]),
        attr("objectClass",["inetOrgPerson","posixAccount"]) ])
  createDN(conn, "cn=rocco,dc=synrc,dc=com",
      [ attr("cn",["rocco"]),attr("uid",["1001"]),
        attr("objectClass",["inetOrgPerson","posixAccount"]) ])
  createDN(conn, "cn=admin,dc=synrc,dc=com",
      [ attr("rootpw",["secret"]), attr("cn",["admin"]),
        attr("objectClass",["inetOrgPerson"]) ])
  def appendNotEmpty([]),  do: []
  def appendNotEmpty(res) do
      res ++ case res do [] -> [] ; _ -> ',' end
  end
  def createDN(db, dn, attributes) do
      norm  = :lists.foldr(fn {:PartialAttribute, att, vals}, acc ->
              :lists.map(fn val -> [qdn(dn),att,val] end, vals) ++ acc end, [], attributes)
      {_,p} = :lists.foldr(fn x, {acc,res}  -> {acc + length(x), appendNotEmpty(res) ++
              :io_lib.format('(?~p,?~p,?~p)',[acc+1,acc+2,acc+3])} end, {0,[]}, norm)
      {:ok, statement} = prepare(db, 'insert into ldap (rdn,att,val) values ' ++ p ++ '')
      :ok = bind(db, statement, :lists.flatten(norm))
      :done = step(db, statement)
  end
   def message(no, socket, {:bindRequest, {_,_,bindDN,{:simple, password}}}, db) do
       {:ok, statement} = prepare(db,
           "select rdn, att from ldap where rdn = ?1 and att = 'rootpw' and val = ?2")
       bind(db, statement, [hash(qdn(bindDN)),password])
       case step(db, statement) do
           :done ->  code = :invalidCredentials
                     :logger.error 'BIND Error: ~p', [code]
                     response = DS."BindResponse"(resultCode: code,
                         matchedDN: "", diagnosticMessage: 'ERROR')
                     answer(response, no, :bindResponse, socket)
            {:row,[dn,password]} ->
                     :logger.info 'BIND DN: ~p', [bindDN]
                     response = DS."BindResponse"(resultCode: :success,
                          matchedDN: "", diagnosticMessage: 'OK')
                     answer(response, no, :bindResponse, socket)
       end
   end

   def message(no, socket, {:bindRequest, {_,_,bindDN,creds}}, db) do
       code = :authMethodNotSupported
       :logger.info 'BIND ERROR: ~p', [code]
       response = DS."BindResponse"(resultCode: code,
          matchedDN: "", diagnosticMessage: 'ERROR')
       answer(response, no, :bindResponse, socket)
   end
\end{lstlisting}

\newpage
\subsubsection{ADD}

\begin{lstlisting}
def message(no, socket, {:addRequest, {_,dn, attributes}}, db) do
      {:ok, statement} = prepare(db, "select rdn, att, val from ldap where rdn = ?1")
      bind(db, statement, [hash(qdn(dn))])
      case step(db, statement) do
            {:row, _} ->
                :logger.info 'ADD ERROR: ~p', [dn]
                resp = DS.'LDAPResult'(resultCode: :entryAlreadyExists,
                       matchedDN: dn, diagnosticMessage: 'ERROR')
                answer(resp, no, :addResponse, socket)
            :done ->
                createDN(db, dn, attributes)
                :logger.info 'ADD DN: ~p', [dn]
                resp = DS.'LDAPResult'(resultCode: :success,
                       matchedDN: dn, diagnosticMessage: 'OK')
                answer(resp, no, :addResponse, socket)
       end
   end
\end{lstlisting}

\newpage
\subsubsection{DSE}

–Ø–∫—à–æ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏ –Ω–∞—à –ø—Ä–æ—Ç–æ-—Å–µ—Ä–≤–µ—Ä –Ω–µ ldapmodify, –∞ Apache Directory Studio, —Ç–æ –≤–æ–Ω–∞ –ø–æ—á–∞—Ç–∫–æ–≤–æ –±—É–¥–µ –ø–∏—Ç–∞—Ç–∏ —Ç–∞–∫ –∑–≤–∞–Ω–∏–π Root DSE –æ–±'—î–∫—Ç –∑–∞–ø–∏—Ç—É—é—á–∏ –ø—ñ—Å–ª—è bind, search —Ä–µ–∫–≤–µ—Å—Ç –∑ –ø—É—Å—Ç–∏–º DN. –î–ª—è –∫–æ—Ä–µ–∫—Ç–Ω–æ—ó —Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ü—ñ—ó —Å–ø–µ—Ü—ñ–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—ó —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –º–∏ –ø—Ä–æ—à–∏—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ —Ü–µ–π –∑–∞–ø–∏—Ç –¥–ª—è –Ω–∞—à–æ–≥–æ —Ñ—ñ—Ä–º–æ–≤–æ–≥–æ SYNRC LDAP —Å–µ—Ä–≤–µ—Ä–∞ –≤–µ—Ä—Å—ñ—ó 2.0 —è–∫–∏–π –ø—ñ–¥—Ç—Ä–∏–º—É—î –ø—Ä–æ—Ç–æ–∫–æ–ª LDAPv3. –í—ñ–Ω –ø—ñ–¥—Ç—Ä–∏–º—É—î SIMPLE —Å–ø–æ—Å—ñ–± –∞—É–Ω—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó —Ç—ñ–ª—å–∫–∏ (–ø–æ–∫–∏ —â–æ) —ñ –¥–≤–∞ —ñ–º–µ–Ω–Ω–∏—Ö –ø—Ä–æ—Å—Ç–æ—Ä–∏ –∫–ª—é—á—ñ–≤: dc=synrc,dc=com ou=schema, —è–∫ –≤–∏–º–∞–Ω–∞—î –¥–µ–∫—ñ–ª—å–∫–∞ RFC. –¶–µ –≤—Å—å–æ –ø–∞–∫—É—î—Ç—å—Å—è —É LDAPMessage —ñ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç—å—Å—è –Ω–∞ –∫–ª—ñ—î–Ω—Ç —Ñ—É–Ω–∫—Ü—ñ—î—é answer.\end{lstlisting}

\begin{lstlisting}
def attr(k,v),      do: {:PartialAttribute, k, v}
   def node(dn,attrs), do: {:SearchResultEntry, dn, attrs}

   def message(no, socket,
       {:searchRequest, {_,"",scope,_,limit,_,_,filter,attributes}}, db) do

       :logger.info 'DSE Scope: ~p', [scope]
       :logger.info 'DSE Filter: ~p', [filter]
       :logger.info 'DSE Attr: ~p', [attributes]

       :lists.map(fn response -> answer(response,no,:searchResEntry,socket) end,
         [ node("", [
              attr("supportedLDAPVersion", ['3']),
              attr("namingContexts", ['dc=synrc,dc=com','ou=schema']),
              attr("supportedControl", ['1.3.6.1.4.1.4203.1.10.1']),
              attr("supportedExtensions", ['1.3.6.1.4.1.4203.1.11.3']),
              attr("altServer", ['ldap.synrc.com']),
              attr("subschemaSubentry", ['ou=schema']),
              attr("vendorName", ['SYNRC LDAP']),
              attr("vendorVersion", ['2.0']),
              attr("supportedSASLMechanisms", ['SIMPLE']),
              attr("objectClass", ['top','extensibleObject']),
              attr("entryUUID", [code()])]),
              attr("supportedFeatures", [ '1.3.6.1.1.14',
                                          '1.3.6.1.4.1.4203.1.5.1'])
         ])

       resp = DS.'LDAPResult'(resultCode: :success, matchedDN: "", diagnosticMessage: 'OK')
       answer(resp, no, :searchResDone,socket)
   end
\end{lstlisting}

–ü—ñ—Å–ª—è —Ü—å–æ–≥–æ –∑–º–æ–∂—É—Ç—å —Ä–æ–∑–≥–æ—Ä—Ç–∞—Ç–∏ –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ –¥–µ—Ä–µ–≤–æ –æ–±'—î–∫—Ç—ñ–≤.

\newpage
\subsubsection{MODIFY}

\begin{lstlisting}
   def modifyDN(db, dn, attributes), do:
       :lists.map(fn {_, :add, x}     -> modifyAdd(db,dn,x)
                     {_, :replace, x} -> modifyReplace(db,dn,x)
                     {_, :delete, x}  -> modifyDelete(db,dn,x) end, attributes)

   def modifyAdd(db, dn, {_,att,[val]}) do
       {:ok, st} = prepare(db, "insert into ldap (rdn,att,val) values (?1,?2,?3)")
       :logger.info 'MOD ADD RDN: ~p', [hash(qdn(dn))]
       bind(db, st, [hash(qdn(dn)),att,val])
       step(db,st)
   end

   def modifyReplace(db, dn, {_,att,[val]}) do
       {:ok, st} = prepare(db, "update ldap set val = ?1 where rdn = ?2 and att = ?3")
       :logger.info 'MOD REPLACE RDN: ~p', [hash(qdn(dn))]
       bind(db, st, [val,hash(qdn(dn)),att])
       step(db,st)
   end

   def modifyDelete(db, dn, {_,att,_}) do
       {:ok, st} = prepare(db, "delete from ldap where rdn = ?1 and att = ?2")
       :logger.info 'MOD DEL RDN: ~p', [hash(qdn(dn))]
       bind(db, st, [hash(qdn(dn)),att])
       res = step(db,st)
       collect0(db,st,res,[])
   end

   def message(no, socket, {:modifyRequest, {_,dn, attributes}}, db) do
      {:ok, statement} = prepare(db, "select rdn, att, val from ldap where rdn = ?1")
      bind(db, statement, [hash(qdn(dn))])
      case step(db, statement) do
           {:row, _} -> :logger.info 'MOD DN: ~p', [dn]
                        modifyDN(db, dn, attributes)
                        resp = DS.'LDAPResult'(resultCode: :success,
                            matchedDN: dn, diagnosticMessage: 'OK')
                        answer(resp, no, :modifyResponse, socket)
           :done ->     :logger.info 'MOD ERROR: ~p', [dn]
                        resp = DS.'LDAPResult'(resultCode: :noSuchObject,
                           matchedDN: dn, diagnosticMessage: 'ERROR')
                        answer(resp, no, :modifyResponse, socket)
      end
   end
\end{lstlisting}

\newpage
\subsubsection{MODIFY DN}

\begin{lstlisting}
   def modifyRDN(socket, no, db, dn, new, del) do
       {:ok, st} = prepare(db, "update ldap set rdn = ?1 where rdn = ?2")
       :logger.info 'MODIFY RDN UPDATE: ~p', [hash(qdn(dn))]
       bind(db, st, [new,hash(qdn(dn))])
       step(db,st)
   end

   def message(no, socket, {:modDNRequest, {_,dn,new,del,_}}, db) do
       :logger.info 'MOD RDN DN: ~p', [dn]
       :logger.info 'MOD RDN newRDN: ~p', [new]
       :logger.info 'MOD RDN deleteOldRDN: ~p', [del]
       modifyRDN(socket, no, db, dn, new, del)
       resp = DS.'LDAPResult'(resultCode: :success,
           matchedDN: dn, diagnosticMessage: 'OK')
       answer(resp, no, :modDNResponse, socket)
   end
\end{lstlisting}

\subsubsection{DELETE}

\begin{lstlisting}
def deleteDN(db, dn) do
       {:ok, st} = prepare(db, "delete from ldap where rdn = ?1")
       bind(db, st, [hash(qdn(dn))])
       res = step(db,st)
       collect0(db,st,res,[])
   end

   def message(no, socket, {:delRequest, dn}, db) do
       :logger.info 'DEL DN: ~p', [dn]
       deleteDN(db, dn)
       resp = DS.'LDAPResult'(resultCode: :success, matchedDN: dn, diagnosticMessage: 'OK')
       answer(resp, no, :delResponse, socket)
   end
\end{lstlisting}

\subsubsection{SEARCH}

\subsubsection{COMPARE}

\begin{lstlisting}
def message(no, socket, {:compareRequest, {_,dn, assertion}}, db) do
       :logger.info 'CMP DN: ~p', [dn]
       :logger.info 'CMP Assertion: ~p', [assertion]
       result = compareDN(db, db, assertion)
       resp = DS.'LDAPResult'(resultCode: :success, matchedDN: dn, diagnosticMessage: 'OK')
       answer(resp, no, :compareResponse, socket)
   end
\end{lstlisting}

\subsubsection{ABANDON/UNBIND}

\begin{lstlisting}
   def message(no, socket, {:abandonRequest, _}, db), do: :gen_tcp.close(socket)
   def message(no, socket, {:unbindRequest,  _}, db), do: :gen_tcp.close(socket)
\end{lstlisting}

\subsection{–í–∏—Å–Ω–æ–≤–∫–∏}

–£ —Ü—ñ–π —Å—Ç–∞—Ç—Ç—ñ –º–∏ –ø–µ—Ä–µ–∫–æ–Ω–∞–ª–∏—Å—è, —â–æ –º–æ–∂–ª–∏–≤–æ –Ω–∞–ø–∏—Å–∞—Ç–∏ LDAP —Å–µ—Ä–≤–µ—Ä –Ω–∞ 300 —Ä—è–¥–∫—ñ–≤, –∞ —Ç–∞–∫–æ–∂ —â–æ SQLite –ø—ñ–¥—Ö–æ–¥–∏—Ç—å –¥–ª—è –º–∞–ª–∏—Ö –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤ —É —è–∫–æ—Å—Ç—ñ —Å—Ö–æ–≤–∏—â–∞ –¥–∞–Ω–∏—Ö. –ú–∏ –≤–∑—è–ª–∏ –ø–æ–≤–Ω–∏–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –ø—Ä–æ–¥—É–∫—Ç–æ–º, —è–∫–∏–π –Ω–µ –º—ñ—Å—Ç–∏—Ç—å –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π, —â–æ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω—É—é—Ç—å –∑–∞ –º–µ–∂–∞–º–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É –≤—ñ—Ä—Ç—É–∞–ª—å–Ω–æ—ó –º–∞—à–∏–Ω–∏, –∞ —Ç–∞–∫–æ–∂ —Å–ø—Ä–æ—Å—Ç–∏–ª–∏ –ø—Ä–æ—Ü–µ—Å —Ä–æ–∑—Ä–æ–±–∫–∏ –±—ñ–ª—å—à —Å–∫–ª–∞–¥–Ω–∏—Ö —Å–∏—Å—Ç–µ–º –Ω–∞ –±–∞–∑—ñ —Ü—å–æ–≥–æ –ø—Ä–æ–¥—É–∫—Ç—É. –ü—Ä–æ–¥—É–∫—Ç –±—É–¥–µ –∫–æ—Ä–∏—Å–Ω–∏–π –¥–ª—è –∞–ø—Ä–æ–±–∞—Ü—ñ—ó –≤ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞ –∑—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–æ–≤–∞–Ω–∏–º–∏ —Ç–∞ —É–Ω—ñ—Ñ—ñ–∫–æ–≤–∞–Ω–∏–º–∏ –ø–æ–ª—ñ—Ç–∏–∫–∞–º–∏ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ä–µ—Å—É—Ä—Å–∞–º–∏ –ø—ñ–¥–ø—Ä–∏—î–º—Å—Ç–≤–∞—Ö, –≤ —Ç–µ–ª–µ–∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ–π–Ω–∏—Ö –ø—Ä–æ–¥—É–∫—Ç–∞—Ö, –∫–æ–º—É–Ω—ñ–∫–∞—Ç–æ—Ä–∞—Ö, –º–µ—Å–µ–Ω–¥–∂–µ—Ä–∞—Ö, —Ç–æ—â–æ.

\begin{lstlisting}
\end{lstlisting}

\section{–ü—Ä–æ—Ç–æ–∫–æ–ª —Ä–æ–∑–º–µ–∂—É–≤–∞–Ω–Ω—è –¥–æ—Å—Ç—É–ø—É ABAC}

\subsection{PEP}
\subsection{PIP}
\subsection{PDP}
